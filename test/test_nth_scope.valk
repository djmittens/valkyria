(load "src/prelude.valk")

(printf "Testing nth scope issue:\n\n")

; Redefine nth with different parameter name
(fun {my-nth n mylist} {
    select
      { (<= n 0) (error "Invalid array index") }
      { (== n 1) (fst mylist) }
      { otherwise (my-nth (- n 1) (tail mylist)) }
})

(= {lst} {10 20 30})
(printf "List: ")
(print lst)

(printf "\nCalling my-nth 1:\n")
(= {result1} (my-nth 1 lst))
(printf "Result: ")
(print result1)

(printf "\nCalling original nth 1:\n") 
(= {result2} (nth 1 lst))
(printf "Result: ")
(print result2)

; Try with even simpler version
(printf "\nSimple version without select:\n")
(fun {simple-nth n l} {
  if (== n 1)
    {fst l}
    {simple-nth (- n 1) (tail l)}
})

(= {result3} (simple-nth 1 lst))
(printf "simple-nth result: ")
(print result3)

(shutdown 0)
