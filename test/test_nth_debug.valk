(load "src/prelude.valk")

(printf "Redefining nth with debug output:\n")

(fun {nth-debug n _l} {
    (printf "  nth-debug called with n=%ld, list=" n)
    (print _l)
    (= {result} (select
      { (<= n 0) (error "Invalid array index (should start with 1)" ) }
      { (== n 1) (fst _l) }
      { otherwise (nth-debug (- n 1) (tail _l)) }))
    (printf "  nth-debug returning: ")
    (print result)
    result
})

(printf "\nTesting nth-debug:\n")
(= {mylist} {10 20 30})
(= {result} (nth-debug 1 mylist))
(printf "Final result: ")
(print result)

(printf "\nTesting original nth:\n")
(= {result2} (nth 1 mylist))
(printf "Original nth result: ")
(print result2)
(printf "Result2 is null? %ld\n" (== result2 nil))

(shutdown 0)
