; Debug the test runner
(load "src/prelude.valk")

; Define minimal test framework
(def {*test-registry*} {})

(fun {test/define name body} {
  (def {*test-registry*} (join *test-registry* (list (list name body))))
})

; Add some tests
(test/define "test-1" {true})
(test/define "test-2" {true})

(printf "Registry: ")
(print *test-registry*)

(printf "\nFirst test: ")
(= {first-test} (nth 1 *test-registry*))
(print first-test)

(printf "\nUsing head on first test: ")
(= {test-head} (head first-test))
(print test-head)

(printf "\nEval head result: ")
(= {test-name} (eval test-head))
(print test-name)

(printf "\nUsing tail on first test: ")
(= {test-tail} (tail first-test))
(print test-tail)

(printf "\nHead of tail: ")
(= {body-qexpr} (head test-tail))
(print body-qexpr)

(printf "\nEval body: ")
(= {test-body} (eval body-qexpr))
(print test-body)

(printf "\nDone debugging\n")
(shutdown 0)