; Test tail call optimization
; This should NOT blow the stack with 100,000 iterations

; Simple tail-recursive countdown
(def {countdown} (\ {n}
  {if (== n 0)
    {0}
    {countdown (- n 1)}}))

; Test with moderate recursion
(print "Testing TCO with 1000 iterations...")
(def {result1} (countdown 1000))
(print "Result: ")
(print result1)
(print "")

; Test with deep recursion (would stack overflow without TCO)
(print "Testing TCO with 100000 iterations...")
(def {result2} (countdown 100000))
(print "Result: ")
(print result2)
(print "")

; Tail-recursive sum
(def {sum-helper} (\ {n acc}
  {if (== n 0)
    {acc}
    {sum-helper (- n 1) (+ acc n)}}))

(def {sum} (\ {n} {sum-helper n 0}))

(print "Testing TCO sum with 10000...")
(def {result3} (sum 10000))
(print "Result: ")
(print result3)
(print "")

(print "TCO tests complete!")
