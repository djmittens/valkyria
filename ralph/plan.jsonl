{"t": "spec", "spec": "deprecate-atoms.md"}
{"t": "task", "id": "t-wt8v", "spec": "deprecate-atoms.md", "name": "Refactor test/test_sse_concurrency_short.valk to remove atoms", "s": "p", "notes": "Use aio/semaphore for rate limiting (MAX_ACTIVE=5), aio/all for result collection, stream/closed for stream state. 8 atoms to remove.", "accept": "grep -c atom test/test_sse_concurrency_short.valk returns 0, test passes", "priority": "high"}
{"t": "task", "id": "t-62en", "spec": "deprecate-atoms.md", "name": "Refactor test/stress/test_sse_concurrency_short.valk to remove atoms", "s": "p", "notes": "Same pattern as test/test_sse_concurrency_short.valk. 8 atoms to remove.", "accept": "grep -c atom test/stress/test_sse_concurrency_short.valk returns 0, test passes", "deps": ["t-wt8v"], "priority": "high"}
{"t": "task", "id": "t-0feb", "spec": "deprecate-atoms.md", "name": "Refactor test/stress/test_sse_concurrency.valk to remove atoms", "s": "p", "notes": "Same pattern as test/test_sse_concurrency_short.valk. 8 atoms to remove.", "accept": "grep -c atom test/stress/test_sse_concurrency.valk returns 0", "deps": ["t-62en"], "priority": "high"}
{"t": "task", "id": "t-v84z", "spec": "deprecate-atoms.md", "name": "Remove async test tracking atoms from test.valk", "s": "p", "notes": "Lines 381-384 define *test-async-pending-atom*, *test-async-passed-atom*, *test-async-failed-atom*, *test-async-timed-out-atom*. Also line 438 has local timed-out atom in *test-start-async-one*. Refactor to return test results via aio/all and reduce. Each test should return {:status :pass/:fail/:timeout}.", "accept": "grep -c test-async-pending-atom src/modules/test.valk returns 0, make test passes", "priority": "high"}
{"t": "task", "id": "t-jyyp", "spec": "deprecate-atoms.md", "name": "Remove *test-suite-timed-out* global atom", "s": "p", "notes": "Lines 9, 79, 295, 329, 500, 530 use *test-suite-timed-out* global atom. Replace with suite-level aio/race pattern or pass timeout state through context.", "accept": "grep -c test-suite-timed-out src/modules/test.valk returns 0, make test passes", "deps": ["t-v84z"], "priority": "high"}
{"t": "task", "id": "t-cavu", "spec": "deprecate-atoms.md", "name": "Verify test.valk has zero atoms and tests pass", "s": "p", "notes": "Final verification: grep -c atom src/modules/test.valk returns 0 AND make test passes.", "accept": "grep -c atom src/modules/test.valk returns 0, make test passes", "deps": ["t-jyyp"], "priority": "high"}
{"t": "task", "id": "t-rvmh", "spec": "deprecate-atoms.md", "name": "Add deprecation warnings to atom builtins in parser.c", "s": "p", "notes": "Add VALK_WARN to valk_builtin_atom, valk_builtin_atom_get, valk_builtin_atom_set, valk_builtin_atom_add, valk_builtin_atom_sub.", "accept": "build/valk -e \"(atom 1)\" prints deprecation warning to stderr, make test passes", "deps": ["t-cavu", "t-0feb"], "priority": "high"}
{"t": "task", "id": "t-vkyr", "spec": "deprecate-atoms.md", "name": "Remove valk_atom_t struct and builtin functions from parser.c", "s": "p", "notes": "Remove lines ~4003-4063 (struct + 5 functions). Phase 5 breaking change.", "accept": "grep -c valk_atom_t src/parser.c returns 0, make build succeeds", "deps": ["t-rvmh"], "priority": "high"}
{"t": "task", "id": "t-2pqn", "spec": "deprecate-atoms.md", "name": "Remove atom builtin registrations from parser.c", "s": "p", "notes": "Remove lines where atom, atom/get, atom/set!, atom/add!, atom/sub! are registered in valk_lenv_put_builtins.", "accept": "grep -c \"\\\"atom\\\"\" src/parser.c returns 0, make build succeeds", "deps": ["t-vkyr"], "priority": "high"}
{"t": "task", "id": "t-xst3", "spec": "deprecate-atoms.md", "name": "Delete test/test_atom_builtins.valk", "s": "p", "notes": "File has tests for atom API. All tests obsolete after atom removal.", "accept": "ls test/test_atom_builtins.valk fails (file does not exist)", "deps": ["t-2pqn"], "priority": "high"}
{"t": "task", "id": "t-71vk", "spec": "deprecate-atoms.md", "name": "Remove atom error tests from test/test_parser_errors.c", "s": "p", "notes": "Remove test_atom_get_wrong_type, test_atom_set_wrong_type, test_atom_add_wrong_type, test_atom_sub_wrong_type.", "accept": "grep -c atom test/test_parser_errors.c returns 0, make test passes", "deps": ["t-xst3"], "priority": "high"}
{"t": "task", "id": "t-s5c4", "spec": "deprecate-atoms.md", "name": "Final verification: no atom references remain", "s": "p", "notes": "Verify: grep -r atom src/*.valk test/*.valk | grep -v atomic | wc -l returns 0. build/valk -e \"(atom 1)\" returns Unknown function error.", "accept": "make test passes, grep -r atom src/*.valk test/*.valk | grep -v atomic | wc -l returns 0", "deps": ["t-71vk"], "priority": "medium"}
{"t": "reject", "id": "t-l7va", "done_at": "71398eb", "reason": "grep -c timed-out src/modules/test.valk returns 34 (not 0). Line 124 in *test-run-one-with-timeout* still contains functional code '(plist/set ctx :timed-out (+ (plist/get ctx :timed-out) 1))' that tracks timeout counts - this is not a string occurrence but actual atom-like state tracking."}
{"t": "reject", "id": "t-l7va", "done_at": "b0117aa", "reason": "Task misspecified: *test-run-one-with-timeout* never had a timed-out atom to remove. Line 124 uses :timed-out as a plist key (not an atom). The local timed-out atom (line 438) is in *test-start-async-one*, not this function. Acceptance criteria 'grep -c timed-out returns 0' is also incorrect - :timed-out plist keys are legitimate non-atom usages."}
