/* Valkyria Dashboard - Modern Observability Interface */
:root {
  --bg-primary: #0d1117;
  --bg-secondary: #161b22;
  --bg-tertiary: #1c2128;
  --bg-elevated: #21262d;
  --border-default: #30363d;
  --border-muted: #21262d;
  --text-primary: #f0f6fc;
  --text-secondary: #c9d1d9;
  --text-muted: #8b949e;
  --text-faint: #7d8590;

  --color-ok: #3fb950;
  --color-ok-muted: #238636;
  --color-ok-bg: rgba(63, 185, 80, 0.15);
  --color-warning: #d29922;
  --color-warning-muted: #9e6a03;
  --color-warning-bg: rgba(210, 153, 34, 0.15);
  --color-error: #f85149;
  --color-error-muted: #da3633;
  --color-error-bg: rgba(248, 81, 73, 0.15);
  --color-info: #58a6ff;
  --color-info-muted: #1f6feb;
  --color-info-bg: rgba(88, 166, 255, 0.15);
  --color-purple: #a371f7;
  --color-purple-muted: #8957e5;
  --color-purple-bg: rgba(163, 113, 247, 0.15);
  --color-cyan: #39d4d4;
  --color-cyan-muted: #2b9e9e;
  --color-cyan-bg: rgba(57, 212, 212, 0.15);
  --color-pink: #db61a2;
  --color-pink-muted: #bf4b8a;
  --color-pink-bg: rgba(219, 97, 162, 0.15);

  --space-xs: 2px;
  --space-sm: 4px;
  --space-md: 6px;
  --space-lg: 10px;
  --space-xl: 16px;
  --space-2xl: 24px;

  --radius-sm: 4px;
  --radius-md: 6px;
  --radius-lg: 8px;
}

* { box-sizing: border-box; margin: 0; padding: 0; }

/* Tooltips - rely on native title attribute but ensure good cursor feedback */
[title] {
  cursor: help;
}

/* Elements that are already interactive keep their cursor */
button[title], a[title], .histogram-bar[title] {
  cursor: pointer;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
  font-size: 14px;
  line-height: 1.5;
  background: var(--bg-primary);
  color: var(--text-secondary);
  min-height: 100vh;
}

/* Screen reader only utility */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Focus styles for keyboard navigation */
:focus-visible {
  outline: 2px solid var(--color-info);
  outline-offset: 2px;
}

/* Skip link for accessibility */
.skip-link {
  position: absolute;
  top: -40px;
  left: 0;
  background: var(--color-info);
  color: white;
  padding: var(--space-sm) var(--space-md);
  z-index: 1000;
  border-radius: var(--radius-sm);
  text-decoration: none;
}
.skip-link:focus {
  top: var(--space-sm);
  left: var(--space-sm);
}

/* ===== HEADER ===== */
header[role="banner"] {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-sm) var(--space-xl);
  background: var(--bg-secondary);
  border-bottom: 1px solid var(--border-default);
  position: sticky;
  top: 0;
  z-index: 100;
  height: 36px;
  overflow: hidden;
}

.header-left {
  display: flex;
  align-items: center;
  gap: var(--space-md);
  flex: 1 1 auto;
  min-width: 0;
  overflow: hidden;
}

.logo {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
}

.logo-icon {
  width: 22px;
  height: 22px;
  background: linear-gradient(135deg, var(--color-info) 0%, var(--color-purple) 100%);
  border-radius: var(--radius-sm);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 11px;
  color: white;
}

.logo-text {
  font-size: 13px;
  font-weight: 600;
  color: var(--text-primary);
}

.logo-text span {
  color: var(--text-muted);
  font-weight: 400;
}

/* Connection status - compact dot indicator */
.status-indicator {
  display: flex;
  align-items: center;
}

.status-dot {
  width: 6px;
  height: 6px;
  background: var(--color-ok);
  border-radius: 50%;
  box-shadow: 0 0 4px var(--color-ok);
  animation: status-glow 2s ease-in-out infinite;
}

.status-indicator.error .status-dot {
  background: var(--color-error);
  box-shadow: 0 0 4px var(--color-error);
}

@keyframes status-glow {
  0%, 100% { opacity: 1; box-shadow: 0 0 4px currentColor; }
  50% { opacity: 0.7; box-shadow: 0 0 8px currentColor; }
}

/* Header metrics row */
.header-metrics {
  display: flex;
  align-items: center;
  gap: var(--space-lg);
  flex-shrink: 0;
}

.header-metric {
  display: flex;
  align-items: center;
  gap: 4px;
}

.header-metric-spark {
  width: 36px;
  height: 14px;
  background: var(--bg-tertiary);
  border-radius: 2px;
  overflow: hidden;
}

.header-metric-spark svg {
  width: 100%;
  height: 100%;
}

.header-metric-value {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-primary);
  font-variant-numeric: tabular-nums;
  min-width: 24px;
}

.header-metric-value.ok { color: var(--color-ok); }
.header-metric-value.warning { color: var(--color-warning); }
.header-metric-value.critical { color: var(--color-error); }

.header-metric-label {
  font-size: 10px;
  color: var(--text-muted);
  white-space: nowrap;
}

/* Legacy support for old status-badge if needed elsewhere */
.status-badge {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 4px 10px;
  background: var(--color-ok-bg);
  border: 1px solid var(--color-ok-muted);
  border-radius: 999px;
  font-size: 12px;
  font-weight: 500;
  color: var(--color-ok);
}

.status-badge.error {
  background: var(--color-error-bg);
  border-color: var(--color-error-muted);
  color: var(--color-error);
}

.status-badge .pulse {
  width: 8px;
  height: 8px;
  background: currentColor;
  border-radius: 50%;
  animation: pulse 2s infinite;
}

.status-icon {
  font-size: 11px;
  margin-right: 2px;
}

@keyframes pulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.6; transform: scale(0.9); }
}

.header-right {
  margin-left: auto;
  display: flex;
  align-items: center;
  gap: var(--space-xl);
}

.header-stat {
  text-align: right;
}

.header-stat-label {
  font-size: 11px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.header-stat-value {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-primary);
  font-variant-numeric: tabular-nums;
}

/* ===== LAYOUT ===== */
main[role="main"] {
  padding: var(--space-xl);
  max-width: 1800px;
  margin: 0 auto;
}

/* ===== HEALTH OVERVIEW PANEL ===== */
.health-overview {
  background: var(--bg-secondary);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-lg);
  padding: var(--space-lg);
  margin-bottom: var(--space-2xl);
}

.health-overview h2 {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: var(--space-md);
  display: flex;
  align-items: center;
  gap: var(--space-sm);
}

.health-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: var(--space-lg);
}

.health-card {
  background: var(--bg-tertiary);
  border-radius: var(--radius-md);
  padding: var(--space-md);
  text-align: center;
}

.health-card-label {
  font-size: 11px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: var(--space-xs);
}

.health-card-value {
  font-size: 24px;
  font-weight: 700;
  color: var(--text-primary);
  font-variant-numeric: tabular-nums;
}

.health-card-value.ok { color: var(--color-ok); }
.health-card-value.warning { color: var(--color-warning); }
.health-card-value.error { color: var(--color-error); }

/* Health Card Status Styles */
.health-card {
  transition: border-color 0.3s ease, box-shadow 0.3s ease;
  border: 2px solid transparent;
}

.health-card.status-ok {
  border-color: var(--color-ok-muted);
  box-shadow: 0 0 0 1px var(--color-ok-bg);
}

.health-card.status-warning {
  border-color: var(--color-warning-muted);
  box-shadow: 0 0 8px var(--color-warning-bg);
}

.health-card.status-critical {
  border-color: var(--color-error-muted);
  box-shadow: 0 0 8px var(--color-error-bg);
  animation: pulse-critical 2s infinite;
}

@keyframes pulse-critical {
  0%, 100% { box-shadow: 0 0 8px var(--color-error-bg); }
  50% { box-shadow: 0 0 16px var(--color-error-bg); }
}

.health-card-subtitle {
  font-size: 11px;
  color: var(--text-faint);
  margin-top: 2px;
}

/* ===== COMPACT HEALTH BAR ===== */
.health-bar-compact {
  display: flex;
  align-items: center;
  gap: var(--space-lg);
  padding: var(--space-sm) var(--space-lg);
  background: var(--bg-secondary);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-lg);
  margin-bottom: var(--space-lg);
}

.health-metric {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  flex: 1;
  min-width: 120px;
}

.health-metric-spark {
  width: 48px;
  height: 20px;
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
  overflow: hidden;
}

.health-metric-spark svg {
  width: 100%;
  height: 100%;
}

.health-metric-label {
  font-size: 11px;
  color: var(--text-muted);
  white-space: nowrap;
}

.health-metric-value {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
  font-variant-numeric: tabular-nums;
}

.health-metric-value.ok { color: var(--color-ok); }
.health-metric-value.warning { color: var(--color-warning); }
.health-metric-value.critical { color: var(--color-error); }

.health-metric-unit {
  font-size: 11px;
  font-weight: 400;
  color: var(--text-muted);
}

.health-divider {
  width: 1px;
  height: 24px;
  background: var(--border-default);
}

/* Responsive: health bar stacks on narrow screens */
@media (max-width: 900px) {
  .health-bar-compact {
    flex-wrap: wrap;
  }

  .health-divider {
    display: none;
  }

  .health-metric {
    min-width: calc(50% - var(--space-lg));
  }
}

@media (max-width: 600px) {
  .health-metric {
    min-width: 100%;
  }
}

/* ===== SECTION GROUPS ===== */
.section-group {
  margin-bottom: var(--space-2xl);
}

/* Section Background Tints */
.section-group.runtime-section {
  background: linear-gradient(135deg, rgba(163, 113, 247, 0.08) 0%, rgba(163, 113, 247, 0.02) 100%);
  border-left: 2px solid rgba(163, 113, 247, 0.4);
  border-radius: var(--radius-lg);
  padding: var(--space-lg);
  margin: 0 calc(-1 * var(--space-lg)) var(--space-2xl);
}

.section-group.aio-section {
  background: linear-gradient(135deg, rgba(57, 212, 212, 0.08) 0%, rgba(57, 212, 212, 0.02) 100%);
  border-left: 2px solid rgba(57, 212, 212, 0.4);
  border-radius: var(--radius-lg);
  padding: var(--space-lg);
  margin: 0 calc(-1 * var(--space-lg)) var(--space-2xl);
}

.section-group.metrics-section {
  background: linear-gradient(135deg, rgba(88, 166, 255, 0.08) 0%, rgba(88, 166, 255, 0.02) 100%);
  border-left: 2px solid rgba(88, 166, 255, 0.4);
  border-radius: var(--radius-lg);
  padding: var(--space-lg);
  margin: 0 calc(-1 * var(--space-lg)) var(--space-2xl);
}

/* Note: .resources-section was removed - resources are now inside AIO panels */

.section-group.http-section {
  background: linear-gradient(135deg, rgba(88, 166, 255, 0.02) 0%, transparent 50%);
  border-radius: var(--radius-lg);
  padding: var(--space-lg);
  margin: 0 calc(-1 * var(--space-lg)) var(--space-2xl);
}

.section-header {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  margin-bottom: var(--space-md);
  padding-bottom: var(--space-xs);
  border-bottom: 1px solid var(--border-muted);
}

.section-icon {
  width: 28px;
  height: 28px;
  border-radius: var(--radius-md);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 700;
}

.section-icon.runtime { background: var(--color-purple-bg); color: var(--color-purple); }
.section-icon.aio { background: var(--color-cyan-bg); color: var(--color-cyan); }
.section-icon.http { background: var(--color-info-bg); color: var(--color-info); }
.section-icon.client { background: var(--color-pink-bg); color: var(--color-pink); }
.section-icon.metrics { background: var(--color-info-bg); color: var(--color-info); }
.section-icon.resources {
  background: var(--color-warning-bg);
  color: var(--color-warning);
}

.section-description {
  font-size: 12px;
  color: var(--text-muted);
  margin-bottom: var(--space-md);
  max-width: 600px;
}

/* .resources-legend removed - no longer needed */

.section-title {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-primary);
}

.section-subtitle {
  font-size: 12px;
  color: var(--text-muted);
  margin-left: var(--space-sm);
}

.section-badges {
  margin-left: auto;
  display: flex;
  gap: var(--space-sm);
}

.section-badge {
  font-size: 11px;
  padding: 2px 8px;
  border-radius: 999px;
  background: var(--bg-elevated);
  color: var(--text-muted);
}

.section-badge.ok { background: var(--color-ok-bg); color: var(--color-ok); }
.section-badge.warning { background: var(--color-warning-bg); color: var(--color-warning); }

/* ===== GRID LAYOUTS ===== */
.grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--space-lg); }
.grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-lg); }
.grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--space-lg); }
.grid-1 { display: grid; grid-template-columns: 1fr; gap: var(--space-lg); }
.span-2 { grid-column: span 2; }

/* ===== PANEL ===== */
.panel {
  background: var(--bg-secondary);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-lg);
  overflow: hidden;
}

.panel-header {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  padding: var(--space-md) var(--space-lg);
  border-bottom: 1px solid var(--border-default);
  background: var(--bg-tertiary);
}

.panel-icon {
  width: 20px;
  height: 20px;
  border-radius: var(--radius-sm);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  font-weight: 700;
}

.panel-icon.gc { background: var(--color-ok-bg); color: var(--color-ok); }
.panel-icon.mem { background: var(--color-purple-bg); color: var(--color-purple); }
.panel-icon.interp { background: var(--color-warning-bg); color: var(--color-warning); }
.panel-icon.aio { background: var(--color-cyan-bg); color: var(--color-cyan); }
.panel-icon.http { background: var(--color-info-bg); color: var(--color-info); }
.panel-icon.client { background: var(--color-pink-bg); color: var(--color-pink); }
.panel-icon.metrics { background: var(--color-info-bg); color: var(--color-info); }

.panel-title {
  font-size: 13px;
  font-weight: 600;
  color: var(--text-primary);
}

.panel-badge {
  margin-left: auto;
  font-size: 11px;
  padding: 2px 6px;
  border-radius: 999px;
  background: var(--bg-elevated);
  color: var(--text-muted);
}

.panel-body {
  padding: var(--space-md) var(--space-lg);
}

/* ===== SERVER/CLIENT CARDS (COMPACT) ===== */
.entity-card {
  background: var(--bg-secondary);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-md);
  overflow: hidden;
}

.entity-card:focus-within {
  border-color: var(--color-info);
}

.entity-header {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 6px 10px;
  background: var(--bg-tertiary);
  border-bottom: 1px solid var(--border-muted);
}

.entity-status {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--color-ok);
  flex-shrink: 0;
}

.entity-status.warning { background: var(--color-warning); }
.entity-status.error { background: var(--color-error); }

.entity-name {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-primary);
  font-family: var(--font-mono);
}

.entity-label {
  font-size: 10px;
  color: var(--text-muted);
  padding: 1px 5px;
  background: var(--bg-elevated);
  border-radius: 999px;
}

.entity-stats {
  margin-left: auto;
  display: flex;
  gap: 10px;
}

.entity-stat {
  text-align: right;
  line-height: 1.2;
}

.entity-stat-value {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-primary);
  font-variant-numeric: tabular-nums;
}

.entity-stat.sse-stat {
  display: none;
}

.entity-stat.sse-stat .entity-stat-value {
  color: var(--color-cyan);
}

.entity-stat-label {
  font-size: 9px;
  color: var(--text-faint);
  text-transform: uppercase;
}

.entity-body {
  padding: 8px 10px;
}

.entity-section {
  margin-bottom: 8px;
}

.entity-section:last-child {
  margin-bottom: 0;
}

.entity-section-title {
  display: none; /* Hide section titles for compact view */
}

/* Compact response codes - inline */
.response-codes-inline {
  display: flex;
  align-items: center;
  gap: 6px;
  flex-wrap: wrap;
}

.code-chip {
  display: inline-flex;
  align-items: center;
  gap: 3px;
  padding: 2px 6px;
  border-radius: 3px;
  font-size: 11px;
  font-weight: 500;
  font-variant-numeric: tabular-nums;
}

.code-chip.s2xx { background: var(--color-ok-bg); color: var(--color-ok); }
.code-chip.s4xx { background: var(--color-warning-bg); color: var(--color-warning); }
.code-chip.s5xx { background: var(--color-error-bg); color: var(--color-error); }
.code-chip .code-label { font-size: 9px; opacity: 0.8; }

.status-bar-compact {
  flex: 1;
  height: 4px;
  min-width: 40px;
  max-width: 80px;
  background: var(--bg-elevated);
  border-radius: 2px;
  overflow: hidden;
  display: flex;
}

/* Compact latency row */
.latency-row {
  display: flex;
  align-items: center;
  gap: 8px;
}

.histogram-mini {
  display: flex;
  align-items: flex-end;
  gap: 1px;
  height: 18px;
  width: 60px;
  flex-shrink: 0;
}

.histogram-mini .bar {
  flex: 1;
  border-radius: 1px 1px 0 0;
  background: var(--color-info-muted);
  min-height: 2px;
  transition: height 0.2s;
}

.histogram-mini .bar.p50 { background: var(--color-ok); }
.histogram-mini .bar.p95 { background: var(--color-warning); }
.histogram-mini .bar.p99 { background: var(--color-error); }

.latency-values {
  display: flex;
  gap: 8px;
  font-size: 11px;
}

.latency-item {
  display: flex;
  align-items: baseline;
  gap: 2px;
}

.latency-item .label {
  font-size: 9px;
  color: var(--text-faint);
  text-transform: lowercase;
}

.latency-item .value {
  font-weight: 600;
  font-variant-numeric: tabular-nums;
}

.latency-item.p50 .value { color: var(--color-ok); }
.latency-item.p95 .value { color: var(--color-warning); }
.latency-item.p99 .value { color: var(--color-error); }

/* Compact throughput */
.throughput-row {
  display: flex;
  gap: 12px;
  font-size: 11px;
}

.throughput-item {
  display: flex;
  align-items: center;
  gap: 3px;
}

.throughput-item .arrow {
  font-size: 10px;
  font-weight: bold;
}

.throughput-item .arrow.in { color: var(--color-ok); }
.throughput-item .arrow.out { color: var(--color-info); }

.throughput-item .value {
  font-weight: 600;
  color: var(--text-primary);
  font-variant-numeric: tabular-nums;
}

/* Compact inline metrics row */
.entity-metrics-row {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  font-size: 11px;
}

.entity-metric {
  display: flex;
  align-items: baseline;
  gap: 3px;
}

.entity-metric-label {
  color: var(--text-muted);
  font-size: 10px;
}

.entity-metric-value {
  font-weight: 600;
  color: var(--text-primary);
  font-variant-numeric: tabular-nums;
}

.entity-metric-value.ok { color: var(--color-ok); }
.entity-metric-value.warning { color: var(--color-warning); }
.entity-metric-value.error { color: var(--color-error); }

/* ===== MINI STATS ===== */
.mini-stats {
  display: flex;
  gap: var(--space-sm);
}

.mini-stat {
  flex: 1;
  padding: var(--space-xs) var(--space-sm);
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
  text-align: center;
  min-width: 0;
}

.mini-stat-value {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
  font-variant-numeric: tabular-nums;
}

.mini-stat-value.ok { color: var(--color-ok); }
.mini-stat-value.warning { color: var(--color-warning); }
.mini-stat-value.error { color: var(--color-error); }

.mini-stat-label {
  font-size: 9px;
  color: var(--text-muted);
  margin-top: 0;
}

/* ===== METRIC ROWS ===== */
.metric-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 6px 0;
  border-bottom: 1px solid var(--border-muted);
  line-height: 1.4;
}

.metric-row:last-child { border-bottom: none; }

.metric-label {
  font-size: 12px;
  color: var(--text-muted);
}

.metric-value {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-primary);
  font-variant-numeric: tabular-nums;
}

.metric-value.ok { color: var(--color-ok); }
.metric-value.warning { color: var(--color-warning); }
.metric-value.error { color: var(--color-error); }

/* ===== PROGRESS BARS ===== */
.progress-bar {
  height: 8px;
  background: var(--bg-elevated);
  border-radius: 999px;
  overflow: hidden;
  margin-top: var(--space-xs);
}

.progress-fill {
  height: 100%;
  border-radius: 999px;
  background: var(--color-info);
  transition: width 0.3s ease;
}

.progress-fill.ok { background: var(--color-ok); }
.progress-fill.warning {
  background: var(--color-warning);
  background-image: repeating-linear-gradient(
    45deg,
    transparent,
    transparent 3px,
    rgba(255,255,255,0.1) 3px,
    rgba(255,255,255,0.1) 6px
  );
}
.progress-fill.critical {
  background: var(--color-error);
  background-image: repeating-linear-gradient(
    45deg,
    transparent,
    transparent 2px,
    rgba(255,255,255,0.15) 2px,
    rgba(255,255,255,0.15) 4px
  );
}

/* ===== GAUGE ===== */
.gauge-container {
  display: flex;
  align-items: center;
  gap: var(--space-lg);
}

.gauge {
  width: 100px;
  height: 100px;
  position: relative;
  flex-shrink: 0;
}

.gauge svg { transform: rotate(-90deg); }

.gauge-bg {
  fill: none;
  stroke: var(--bg-tertiary);
  stroke-width: 10;
}

.gauge-threshold {
  fill: none;
  stroke-width: 10;
  opacity: 0.3;
}

.gauge-threshold.warning { stroke: var(--color-warning); }
.gauge-threshold.critical { stroke: var(--color-error); }

.gauge-fill {
  fill: none;
  stroke: var(--color-ok);
  stroke-width: 10;
  stroke-linecap: round;
  transition: stroke-dashoffset 0.5s ease, stroke 0.3s ease;
}

.gauge-fill.warning { stroke: var(--color-warning); }
.gauge-fill.critical { stroke: var(--color-error); }

.gauge-center {
  position: absolute;
  top: 0; right: 0; bottom: 0; left: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.gauge-value {
  font-size: 20px;
  font-weight: 700;
  color: var(--text-primary);
}

.gauge-trend {
  font-size: 12px;
  margin-left: 2px;
}

.gauge-trend.up { color: var(--color-warning); }
.gauge-trend.down { color: var(--color-ok); }
.gauge-trend.stable { color: var(--text-muted); }

.gauge-label {
  font-size: 11px;
  color: var(--text-muted);
  text-transform: uppercase;
}

.gauge-details { flex: 1; }

/* ===== HISTOGRAM ===== */
.histogram-container {
  display: flex;
  flex-direction: column;
}

.histogram {
  display: flex;
  align-items: flex-end;
  gap: 3px;
  height: 60px;
}

.histogram-bar-wrap {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-end;
  min-width: 0;
  height: 100%;
}

.histogram-bar {
  width: 100%;
  border-radius: 2px 2px 0 0;
  background: var(--color-info);
  transition: height 0.3s ease, background-color 0.3s ease;
  min-height: 2px;
  cursor: pointer;
}

.histogram-bar-label {
  font-size: 8px;
  color: var(--text-faint);
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
  max-width: 100%;
  text-align: center;
  flex-shrink: 0;
  height: 12px;
  line-height: 12px;
}

.histogram-bar:hover { filter: brightness(1.2); }
.histogram-bar:focus-visible {
  outline: 2px solid var(--text-primary);
  outline-offset: 1px;
}
.histogram-bar.p50 { background: var(--color-ok); }
.histogram-bar.p95 { background: var(--color-warning); }
.histogram-bar.p99 { background: var(--color-error); }

.histogram-axis {
  display: flex;
  justify-content: space-between;
  margin-top: 2px;
  font-size: 9px;
  color: var(--text-faint);
  padding: 0 2px;
}

.histogram-axis span {
  white-space: nowrap;
}

.histogram-meta {
  display: flex;
  justify-content: space-between;
  margin-top: var(--space-xs);
  font-size: 11px;
  color: var(--text-faint);
}

.percentiles {
  display: flex;
  gap: var(--space-md);
  margin-top: var(--space-sm);
}

.percentile {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 11px;
}

.percentile-dot {
  width: 8px;
  height: 8px;
  border-radius: 2px;
}

.percentile-dot.p50 { background: var(--color-ok); }
.percentile-dot.p95 { background: var(--color-warning); }
.percentile-dot.p99 { background: var(--color-error); }

.percentile-label { color: var(--text-muted); }
.percentile-value { color: var(--text-primary); font-weight: 600; }

/* ===== GC TIMELINE ===== */
.gc-timeline {
  height: 36px;
  position: relative;
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
  overflow: hidden;
}

.gc-timeline-axis {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 10px;
  background: rgba(0,0,0,0.2);
  display: flex;
  justify-content: space-between;
  padding: 0 var(--space-xs);
  font-size: 8px;
  color: var(--text-faint);
  align-items: center;
}

.gc-timeline-bar {
  position: absolute;
  bottom: 10px;
  width: 3px;
  background: var(--color-ok);
  border-radius: 2px 2px 0 0;
  min-height: 2px;
}

.gc-timeline-bar:hover { filter: brightness(1.3); }
.gc-timeline-bar.warning { background: var(--color-warning); }
.gc-timeline-bar.critical { background: var(--color-error); }

.gc-timeline-threshold {
  position: absolute;
  left: 0;
  right: 0;
  height: 1px;
  background: var(--color-warning);
  opacity: 0.5;
}

.gc-timeline-threshold-label {
  position: absolute;
  right: var(--space-xs);
  font-size: 9px;
  color: var(--color-warning);
  transform: translateY(-100%);
}

.gc-event {
  position: absolute;
  bottom: 10px;
  width: 3px;
  background: var(--color-ok);
  border-radius: 2px 2px 0 0;
  cursor: pointer;
}

.gc-event:hover { filter: brightness(1.3); }
.gc-event.major { background: var(--color-warning); width: 4px; }
.gc-event.long { background: var(--color-error); }

.gc-stats {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-sm) var(--space-lg);
  margin-top: var(--space-sm);
  padding: var(--space-sm);
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
}

.gc-stat {
  display: inline-flex;
  align-items: baseline;
  gap: var(--space-xs);
  padding: 0;
  background: transparent;
}

.gc-stat-value {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
}

.gc-stat-value .unit {
  font-size: 11px;
  font-weight: 400;
  color: var(--text-muted);
}

.gc-stat-label {
  font-size: 10px;
  color: var(--text-muted);
  margin-top: 0;
}

/* ===== GC + INTERPRETER UNIFIED STATS ROW ===== */
.gc-interp-stats {
  display: flex;
  align-items: stretch;
  gap: 0;
  margin-top: var(--space-sm);
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
  overflow: hidden;
}

.gc-interp-stats .gc-stats {
  margin-top: 0;
  border-radius: 0;
  flex: 1;
}

.gc-interp-sep {
  width: 1px;
  background: var(--border-default);
  margin: var(--space-sm) 0;
}

.interp-stats {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-sm) var(--space-lg);
  padding: var(--space-sm);
  flex: 1;
  align-items: center;
}

.interp-stat {
  display: inline-flex;
  align-items: baseline;
  gap: var(--space-xs);
}

.interp-stat-value {
  font-size: 14px;
  font-weight: 600;
  color: var(--color-warning);
}

.interp-stat-value .unit {
  font-size: 11px;
  font-weight: 400;
  color: var(--text-muted);
}

.interp-stat-label {
  font-size: 10px;
  color: var(--text-muted);
}

.interp-stat.with-spark {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
}

.interp-stat-spark {
  width: 48px;
  height: 24px;
  background: var(--bg-primary);
  border-radius: var(--radius-sm);
  overflow: hidden;
}

/* Responsive: stack on narrow screens */
@media (max-width: 900px) {
  .gc-interp-stats {
    flex-direction: column;
  }

  .gc-interp-sep {
    width: auto;
    height: 1px;
    margin: 0 var(--space-sm);
  }
}

/* ===== GC SURVIVAL HISTOGRAM (Leak Detection) ===== */
.gc-survival-section {
  margin-top: var(--space-md);
  padding: var(--space-sm);
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
}

.gc-survival-header {
  display: flex;
  align-items: center;
  gap: var(--space-md);
  margin-bottom: var(--space-sm);
}

.gc-survival-title {
  font-size: 11px;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
}

.gc-survival-efficiency {
  font-size: 11px;
  color: var(--text-muted);
  margin-left: auto;
}

.gc-survival-efficiency #gc-efficiency-value {
  font-weight: 600;
  color: var(--color-ok);
}

.gc-survival-efficiency #gc-efficiency-value.warning {
  color: var(--color-warning);
}

.gc-survival-efficiency #gc-efficiency-value.critical {
  color: var(--color-error);
}

.gc-leak-warning {
  font-size: 10px;
  padding: 2px 6px;
  border-radius: 999px;
  background: var(--color-error-bg);
  color: var(--color-error);
  font-weight: 600;
  animation: leak-pulse 2s ease-in-out infinite;
}

@keyframes leak-pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.6; }
}

.gc-survival-histogram {
  display: flex;
  gap: var(--space-sm);
  height: 48px;
  align-items: flex-end;
}

.gc-survival-bar {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
  height: 100%;
}

.gc-survival-bar-fill {
  width: 100%;
  border-radius: var(--radius-sm) var(--radius-sm) 0 0;
  min-height: 2px;
  transition: height 0.3s ease;
  position: absolute;
  bottom: 16px;
}

.gc-survival-bar.gen-0 .gc-survival-bar-fill {
  background: var(--color-ok);
}

.gc-survival-bar.gen-1-5 .gc-survival-bar-fill {
  background: var(--color-info);
}

.gc-survival-bar.gen-6-20 .gc-survival-bar-fill {
  background: var(--color-warning);
}

.gc-survival-bar.gen-21-plus .gc-survival-bar-fill {
  background: var(--color-error);
}

.gc-survival-bar-label {
  position: absolute;
  bottom: 0;
  font-size: 9px;
  color: var(--text-faint);
}

.gc-survival-bar-count {
  position: absolute;
  bottom: 18px;
  font-size: 9px;
  color: var(--text-muted);
  font-weight: 600;
  font-variant-numeric: tabular-nums;
  transform: translateY(-100%);
}

.gc-survival-legend {
  display: flex;
  gap: var(--space-md);
  margin-top: var(--space-sm);
  flex-wrap: wrap;
}

.gc-survival-legend-item {
  display: flex;
  align-items: center;
  gap: var(--space-xs);
  font-size: 10px;
  color: var(--text-muted);
}

.gc-survival-legend-item .legend-dot {
  width: 8px;
  height: 8px;
  border-radius: 2px;
}

.gc-survival-legend-item .legend-dot.gen-0 { background: var(--color-ok); }
.gc-survival-legend-item .legend-dot.gen-1-5 { background: var(--color-info); }
.gc-survival-legend-item .legend-dot.gen-6-20 { background: var(--color-warning); }
.gc-survival-legend-item .legend-dot.gen-21-plus { background: var(--color-error); }

/* ===== PARALLEL GC SECTION ===== */
.gc-parallel-section {
  margin-top: var(--space-md);
  padding-top: var(--space-sm);
  border-top: 1px solid var(--border-subtle);
}

.gc-parallel-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-lg);
}

@media (max-width: 800px) {
  .gc-parallel-grid {
    grid-template-columns: 1fr;
  }
}

/* Pause Histogram */
.gc-pause-section {
  display: flex;
  flex-direction: column;
}

.gc-pause-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-sm);
}

.gc-pause-title {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-secondary);
}

.gc-pause-histogram {
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
  height: 60px;
  gap: 4px;
  padding: var(--space-sm);
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
}

.gc-pause-bar {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  height: 100%;
  position: relative;
}

.gc-pause-bar-fill {
  width: 100%;
  max-width: 28px;
  border-radius: 2px 2px 0 0;
  min-height: 2px;
  position: absolute;
  bottom: 20px;
  transition: height 0.3s ease;
}

.gc-pause-bar-fill.ok { background: var(--color-ok); }
.gc-pause-bar-fill.ok-muted { background: var(--color-ok-muted, #238636); }
.gc-pause-bar-fill.warning { background: var(--color-warning); }
.gc-pause-bar-fill.warning-strong { background: var(--color-warning-muted, #9e6a03); }
.gc-pause-bar-fill.error { background: var(--color-error); }

.gc-pause-bar-label {
  font-size: 9px;
  color: var(--text-faint);
  position: absolute;
  bottom: 0;
  white-space: nowrap;
}

.gc-pause-bar-count {
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--text-muted);
  position: absolute;
  bottom: 22px;
  transform: translateY(-100%);
}

/* Size Class Grid */
.gc-size-class-section {
  display: flex;
  flex-direction: column;
}

.gc-size-class-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-sm);
}

.gc-size-class-title {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-secondary);
}

.gc-large-objects {
  font-size: 11px;
  font-family: var(--font-mono);
  color: var(--text-muted);
}

.gc-size-class-grid {
  display: grid;
  grid-template-columns: repeat(9, 1fr);
  gap: 3px;
  padding: var(--space-sm);
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
}

.gc-size-class {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.gc-size-class-bar {
  width: 100%;
  height: 32px;
  background: var(--bg-elevated);
  border-radius: 2px;
  position: relative;
  overflow: hidden;
}

.gc-size-class-bar::before {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: var(--usage, 0%);
  background: var(--color-info);
  border-radius: 2px;
  transition: height 0.3s ease;
}

.gc-size-class span {
  font-size: 8px;
  color: var(--text-faint);
  margin-top: 2px;
}

/* Parallel badge styles - Enhanced */
#gc-parallel-badge {
  background: var(--bg-elevated);
  color: var(--text-muted);
  display: flex;
  align-items: center;
  gap: 6px;
}

#gc-parallel-badge .parallel-indicator {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--text-muted);
  transition: all 0.3s ease;
}

#gc-parallel-badge.parallel-active {
  background: var(--color-ok-bg);
  color: var(--color-ok);
}

#gc-parallel-badge.parallel-active .parallel-indicator {
  background: var(--color-ok);
  box-shadow: 0 0 8px var(--color-ok), 0 0 16px var(--color-ok);
  animation: parallel-pulse 1.5s ease-in-out infinite;
}

@keyframes parallel-pulse {
  0%, 100% { box-shadow: 0 0 4px var(--color-ok); }
  50% { box-shadow: 0 0 12px var(--color-ok), 0 0 20px var(--color-ok); }
}

/* Allocation rate badge */
.gc-alloc-rate-badge {
  background: var(--bg-elevated);
  display: flex;
  align-items: center;
  gap: 2px;
}

.gc-alloc-rate-badge .alloc-rate-value {
  font-family: var(--font-mono);
  font-weight: 600;
  color: var(--color-cyan);
}

.gc-alloc-rate-badge .alloc-rate-unit {
  font-size: 10px;
  color: var(--text-muted);
}

/* ===== HEAP PRESSURE GAUGE ===== */
.gc-heap-pressure {
  display: flex;
  gap: var(--space-xl);
  padding: var(--space-md);
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
  margin-bottom: var(--space-md);
  align-items: center;
}

.heap-pressure-gauge {
  position: relative;
  width: 180px;
  flex-shrink: 0;
}

.heap-pressure-gauge svg.pressure-arc {
  width: 100%;
  height: 90px;
}

.heap-pressure-gauge .arc-bg {
  opacity: 0.3;
}

.heap-pressure-gauge .arc-fill {
  transition: stroke-dashoffset 0.5s ease-out;
}

.pressure-center {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -20%);
  text-align: center;
}

.pressure-value {
  font-size: 28px;
  font-weight: 700;
  font-family: var(--font-mono);
  color: var(--text-primary);
  line-height: 1;
}

.pressure-label {
  font-size: 10px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.pressure-stats {
  display: flex;
  justify-content: space-between;
  padding: 0 var(--space-md);
  margin-top: -10px;
}

.pressure-stat {
  text-align: center;
}

.pressure-stat-value {
  font-family: var(--font-mono);
  font-size: 11px;
  font-weight: 600;
  color: var(--text-primary);
}

.pressure-stat-label {
  font-size: 9px;
  color: var(--text-faint);
  text-transform: uppercase;
}

/* Allocation rate sparkline */
.heap-alloc-sparkline {
  flex: 1;
  min-width: 0;
}

.alloc-spark-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-xs);
}

.alloc-spark-title {
  font-size: 11px;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
}

.alloc-spark-value {
  font-family: var(--font-mono);
  font-size: 14px;
  font-weight: 600;
  color: var(--color-cyan);
}

.alloc-spark-container {
  height: 48px;
  background: var(--bg-elevated);
  border-radius: var(--radius-sm);
  overflow: hidden;
}

/* ===== ENHANCED SIZE CLASS GRID ===== */
.gc-size-class-grid {
  display: grid;
  grid-template-columns: repeat(9, 1fr);
  gap: 4px;
  padding: var(--space-sm);
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
}

.gc-size-class {
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
}

.gc-size-class-bar {
  width: 100%;
  height: 40px;
  background: var(--bg-elevated);
  border-radius: 3px;
  position: relative;
  overflow: hidden;
}

.gc-size-class-fill {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: var(--usage, 0%);
  background: linear-gradient(180deg, var(--color-cyan), var(--color-info));
  border-radius: 3px;
  transition: height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.gc-size-class-glow {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: var(--usage, 0%);
  background: linear-gradient(180deg, transparent 0%, rgba(57, 212, 212, 0.3) 100%);
  filter: blur(4px);
  opacity: 0.7;
  transition: height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.gc-size-class:hover .gc-size-class-fill {
  background: linear-gradient(180deg, var(--color-cyan), var(--color-purple));
}

.gc-size-class:hover .gc-size-class-glow {
  opacity: 1;
}

.gc-size-class-label {
  font-size: 8px;
  color: var(--text-faint);
  margin-top: 3px;
}

.gc-size-class-tooltip {
  position: absolute;
  top: -32px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--bg-primary);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-sm);
  padding: 3px 6px;
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--text-primary);
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s ease;
  z-index: 10;
}

.gc-size-class:hover .gc-size-class-tooltip {
  opacity: 1;
}

.gc-size-class-legend {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  margin-top: var(--space-sm);
  font-size: 9px;
  color: var(--text-faint);
}

.gc-size-class-legend .legend-gradient {
  flex: 1;
  height: 4px;
  background: linear-gradient(90deg, var(--bg-elevated), var(--color-info), var(--color-cyan));
  border-radius: 2px;
}

/* ===== THREAD ACTIVITY VISUALIZATION ===== */
.gc-thread-activity {
  margin-top: var(--space-md);
  padding: var(--space-sm);
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
}

.thread-activity-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-sm);
}

.thread-activity-title {
  font-size: 11px;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
}

.thread-activity-count {
  font-size: 11px;
  color: var(--text-muted);
}

.thread-activity-grid {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
}

.thread-indicator {
  width: 24px;
  height: 24px;
  border-radius: var(--radius-sm);
  background: var(--bg-elevated);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  font-weight: 600;
  color: var(--text-muted);
  transition: all 0.3s ease;
  border: 1px solid transparent;
}

.thread-indicator.active {
  background: var(--color-ok-bg);
  color: var(--color-ok);
  border-color: var(--color-ok);
}

.thread-indicator.marking {
  background: var(--color-cyan-bg);
  color: var(--color-cyan);
  border-color: var(--color-cyan);
  animation: thread-work 0.5s ease-in-out infinite;
}

.thread-indicator.sweeping {
  background: var(--color-purple-bg);
  color: var(--color-purple);
  border-color: var(--color-purple);
  animation: thread-work 0.5s ease-in-out infinite;
}

@keyframes thread-work {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

/* ===== PAUSE HISTOGRAM ENHANCEMENTS ===== */
.gc-avg-pause {
  font-size: 11px;
  font-family: var(--font-mono);
  color: var(--text-muted);
}

.gc-pause-bar-fill {
  box-shadow: 0 0 8px currentColor;
}

.gc-pause-bar-fill.ok { 
  background: linear-gradient(180deg, var(--color-ok), var(--color-ok-muted));
  box-shadow: 0 0 8px var(--color-ok);
}

.gc-pause-bar-fill.ok-muted { 
  background: linear-gradient(180deg, #2ea043, var(--color-ok-muted));
  box-shadow: 0 0 6px var(--color-ok-muted);
}

.gc-pause-bar-fill.warning { 
  background: linear-gradient(180deg, var(--color-warning), var(--color-warning-muted));
  box-shadow: 0 0 8px var(--color-warning);
}

.gc-pause-bar-fill.warning-strong { 
  background: linear-gradient(180deg, #e3b341, var(--color-warning-muted));
  box-shadow: 0 0 8px var(--color-warning-muted);
}

.gc-pause-bar-fill.error { 
  background: linear-gradient(180deg, var(--color-error), var(--color-error-muted));
  box-shadow: 0 0 10px var(--color-error);
  animation: error-glow 1s ease-in-out infinite;
}

@keyframes error-glow {
  0%, 100% { box-shadow: 0 0 6px var(--color-error); }
  50% { box-shadow: 0 0 12px var(--color-error), 0 0 20px var(--color-error); }
}

/* ===== CONNECTION POOL ===== */
.conn-pool-bar {
  height: 24px;
  background: var(--bg-elevated);
  border-radius: var(--radius-sm);
  overflow: hidden;
  display: flex;
}

.conn-pool-segment {
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  font-weight: 600;
  color: white;
  min-width: 0;
  transition: width 0.3s ease;
}

.conn-pool-segment.active { background: var(--color-ok); }
.conn-pool-segment.idle { background: var(--color-info-muted); }
.conn-pool-segment.closing { background: var(--color-warning); }

.conn-pool-segment span {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  padding: 0 4px;
}

/* ===== UNIFIED LEGEND STYLES ===== */
/* Base legend - used by conn-legend, slab-state-legend, breakdown-by-state, etc. */
.legend,
.conn-legend,
.slab-state-legend,
.breakdown-by-state,
.memory-legend-inline,
.owner-bar-legend {
  display: flex;
  gap: var(--space-md);
  font-size: 11px;
  color: var(--text-muted);
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 4px;
}

.legend-dot {
  width: 8px;
  height: 8px;
  border-radius: 2px;
}

/* State colors - unified across all grids */
.legend-dot.active { background: var(--color-ok); }
.legend-dot.idle { background: var(--color-info-muted); }
.legend-dot.closing { background: var(--color-warning); }
.legend-dot.free {
  background: var(--bg-elevated);
  border: 1px solid var(--border-default);
}
.legend-dot.used { background: var(--color-ok); }
.legend-dot.flash { background: var(--color-warning); }

/* Legend context-specific spacing */
.conn-legend { margin-top: var(--space-sm); }
.slab-state-legend { margin-top: var(--space-sm); }
.memory-legend-inline {
  padding-top: var(--space-sm);
  border-top: 1px dashed var(--border-muted);
  font-size: 10px;
}

/* ===== SPARKLINE ===== */
.sparkline-container {
  position: relative;
}

.sparkline {
  height: 40px;
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
  overflow: hidden;
}

.sparkline svg {
  width: 100%;
  height: 100%;
}

.sparkline-path {
  fill: none;
  stroke-width: 1.5;
}

.sparkline-area {
  opacity: 0.2;
}

.sparkline-time-label {
  position: absolute;
  bottom: 2px;
  font-size: 9px;
  color: var(--text-faint);
  pointer-events: none;
}

.sparkline-time-label.start { left: 4px; }
.sparkline-time-label.end { right: 4px; }

.sparkline-meta {
  display: flex;
  justify-content: space-between;
  margin-top: var(--space-xs);
  font-size: 11px;
}

.sparkline-stat {
  display: flex;
  align-items: center;
  gap: 4px;
}

.sparkline-dot {
  width: 8px;
  height: 3px;
  border-radius: 1px;
}

.sparkline-dot.in { background: var(--color-ok); }
.sparkline-dot.out { background: var(--color-info); }

.sparkline-label { color: var(--text-muted); }
.sparkline-value { color: var(--text-primary); font-weight: 600; }

/* ===== STATUS BREAKDOWN ===== */
.status-row {
  display: flex;
  gap: var(--space-sm);
}

.status-chip {
  flex: 1;
  padding: var(--space-xs) var(--space-sm);
  border-radius: var(--radius-sm);
  text-align: center;
  border: 1px solid transparent;
}

.status-chip.s2xx { background: var(--color-ok-bg); border-color: var(--color-ok-muted); }
.status-chip.s4xx { background: var(--color-warning-bg); border-color: var(--color-warning-muted); }
.status-chip.s5xx { background: var(--color-error-bg); border-color: var(--color-error-muted); }

.status-chip-value {
  font-size: 14px;
  font-weight: 700;
  font-variant-numeric: tabular-nums;
}

.status-chip.s2xx .status-chip-value { color: var(--color-ok); }
.status-chip.s4xx .status-chip-value { color: var(--color-warning); }
.status-chip.s5xx .status-chip-value { color: var(--color-error); }

.status-chip-label {
  font-size: 11px;
  color: var(--text-muted);
}

.status-bar {
  height: 8px;
  background: var(--bg-tertiary);
  border-radius: 999px;
  overflow: hidden;
  display: flex;
  margin-top: var(--space-sm);
}

.status-segment {
  height: 100%;
  min-width: 2px;
}
.status-segment.s2xx { background: var(--color-ok); }
.status-segment.s4xx { background: var(--color-warning); }
.status-segment.s5xx { background: var(--color-error); }

/* ===== POOL ITEMS ===== */
.pool-item {
  margin-bottom: var(--space-md);
}

.pool-item:last-child { margin-bottom: 0; }

/* pool-header and pool-name use unified slab/pool styles */

.pool-usage {
  font-size: 12px;
  color: var(--text-muted);
}

/* ===== ERROR BANNER ===== */
.error-banner {
  display: none;
  background: var(--color-error-bg);
  border: 1px solid var(--color-error-muted);
  border-radius: var(--radius-md);
  padding: var(--space-md) var(--space-lg);
  margin-bottom: var(--space-lg);
  color: var(--color-error);
  align-items: center;
  gap: var(--space-sm);
}

.error-banner.visible {
  display: flex;
}

.error-banner-icon {
  font-size: 16px;
}

.error-banner-text {
  flex: 1;
}

.error-banner-dismiss {
  background: transparent;
  border: none;
  color: var(--color-error);
  cursor: pointer;
  font-size: 16px;
  padding: 4px;
}

/* SSE Status Warning */
.sse-status-warning {
  display: none;
  background: var(--color-warning-bg);
  border: 1px solid var(--color-warning-muted);
  color: var(--color-warning);
  padding: var(--space-sm) var(--space-md);
  border-radius: var(--radius-md);
  margin-bottom: var(--space-md);
  font-size: 12px;
}

.sse-status-warning.visible {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
}

/* Capacity Warning Banner */
.capacity-warning-banner {
  display: none;
  background: var(--color-warning-bg);
  border: 1px solid var(--color-warning-muted);
  color: var(--color-warning);
  padding: var(--space-sm) var(--space-md);
  border-radius: var(--radius-md);
  margin-bottom: var(--space-md);
  font-size: 12px;
  font-weight: 500;
  align-items: center;
  gap: var(--space-sm);
}

.capacity-warning-banner.visible {
  display: flex;
}

.capacity-warning-banner.critical {
  background: var(--color-error-bg);
  border-color: var(--color-error-muted);
  color: var(--color-error);
  animation: pulse-critical 2s infinite;
}

.capacity-warning-icon {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: currentColor;
  color: var(--bg-primary);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 700;
  flex-shrink: 0;
}

.capacity-warning-text {
  flex: 1;
}

/* Stale panel indicator */
.panel.stale {
  opacity: 0.7;
  position: relative;
}

.panel.stale::before {
  content: 'Data may be stale';
  position: absolute;
  top: var(--space-sm);
  right: var(--space-sm);
  font-size: 10px;
  color: var(--color-warning);
  background: var(--color-warning-bg);
  padding: 2px 6px;
  border-radius: var(--radius-sm);
  z-index: 10;
}

/* ===== RESPONSIVE ===== */
@media (max-width: 1400px) {
  .grid-4 { grid-template-columns: repeat(2, 1fr); }
  .grid-3 { grid-template-columns: repeat(2, 1fr); }
  .health-grid { grid-template-columns: repeat(2, 1fr); }
}

@media (max-width: 1200px) {
  .grid-3 { grid-template-columns: repeat(2, 1fr); }
  .memory-slab-grid { grid-template-columns: repeat(2, 1fr); }

  .vm-memory-layout {
    grid-template-columns: 1fr;
  }

  .vm-memory-consolidated {
    flex-direction: column;
  }

  .vm-memory-consolidated .arenas-block {
    max-width: none;
  }

  .vm-memory-layout .memory-slab-panel.wide,
  .vm-memory-layout .memory-arena-section.compact {
    grid-column: 1;
  }
}

@media (max-width: 900px) {
  .grid-4, .grid-3, .grid-2 { grid-template-columns: 1fr; }
  .span-2 { grid-column: span 1; }
  .health-grid { grid-template-columns: 1fr; }

  header[role="banner"] {
    flex-wrap: wrap;
    gap: var(--space-sm);
  }

  .header-right {
    width: 100%;
    justify-content: space-between;
  }

  .entity-header {
    flex-wrap: wrap;
  }

  .entity-stats {
    width: 100%;
    margin-top: var(--space-sm);
    margin-left: 0;
    justify-content: flex-start;
  }
}

@media (max-width: 600px) {
  .memory-slab-grid {
    grid-template-columns: 1fr;
  }

  /* Mobile slab summary mode - hide visual grid on small screens */
  .slab-canvas {
    display: none;
  }

  .memory-slab-panel::after {
    content: 'Expand on desktop to view grid';
    display: block;
    text-align: center;
    color: var(--text-muted);
    font-size: 11px;
    padding: var(--space-md);
    background: var(--bg-tertiary);
    border-radius: var(--radius-sm);
    margin-top: var(--space-sm);
  }

  /* Touch target improvements */
  .error-banner-dismiss {
    min-width: 44px;
    min-height: 44px;
    padding: var(--space-md);
  }

  .expand-toggle {
    min-width: 44px;
    min-height: 44px;
  }

  /* Histogram bars touch targets */
  .histogram-bar {
    min-width: 24px;
  }

  /* Section badges wrap */
  .section-badges {
    flex-wrap: wrap;
    gap: var(--space-xs);
  }

  /* Health cards stack */
  .health-grid {
    grid-template-columns: repeat(2, 1fr);
  }

  /* VM memory consolidated stacks */
  .vm-memory-consolidated {
    flex-direction: column;
  }

  .vm-memory-consolidated .arenas-block {
    max-width: none;
  }

  /* Reduce padding on mobile */
  main[role="main"] {
    padding: var(--space-md);
  }

  .section-group.runtime-section,
  .section-group.aio-section,
  .section-group.metrics-section,
  .section-group.http-section {
    padding: var(--space-md);
    margin-left: calc(-1 * var(--space-md));
    margin-right: calc(-1 * var(--space-md));
  }
}

@media (max-width: 375px) {
  .health-grid {
    grid-template-columns: 1fr;
  }

  .mini-stats {
    flex-direction: column;
  }

  .gc-stats {
    grid-template-columns: repeat(2, 1fr);
  }

  .percentiles {
    flex-wrap: wrap;
    gap: var(--space-xs);
  }

  .entity-stats {
    flex-direction: column;
    gap: var(--space-sm);
  }

  .header-right {
    flex-direction: column;
    gap: var(--space-xs);
  }
}

@media (prefers-reduced-motion: reduce) {
  .pulse { animation: none; }
  .progress-fill, .gauge-fill, .histogram-bar { transition: none; }
  .entity-card { animation: none; }
  .slab-cell { transition: none; }
  .arena-bar { transition: none; }
  .health-card { transition: none; }
  .entity-status { transition: none; }
  @keyframes skeleton-pulse { 0%, 100% { opacity: 0.6; } }
}

/* ===== SUBSECTION HEADERS ===== */
.subsection-header {
  display: flex;
  align-items: center;
  gap: var(--space-md);
  margin-top: var(--space-xl);
  margin-bottom: var(--space-md);
  padding: var(--space-sm) var(--space-md);
  background: var(--bg-tertiary);
  border-left: 3px solid var(--color-purple);
  border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
}

.subsection-title {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.75px;
}

.subsection-header .section-badges {
  margin-left: auto;
}

/* ===== VM MEMORY LAYOUT ===== */
.vm-memory-layout {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: var(--space-md);
}

.vm-memory-layout .memory-slab-panel.wide {
  grid-column: 1;
}

.vm-memory-layout .memory-arena-section.compact {
  grid-column: 2;
  margin-bottom: 0;
}

/* ===== AIO MEMORY GRID ===== */
.aio-memory-grid {
  margin-bottom: 0;
}

/* ===== MEMORY DIAGNOSTICS SECTION ===== */
.memory-diagnostics-section {
  margin-top: var(--space-2xl);
}

.memory-slab-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--space-md);
  margin-bottom: var(--space-lg);
}

/* ===== UNIFIED SLAB/POOL PANEL STYLES ===== */
.memory-slab-panel,
.resource-pool-panel {
  background: var(--bg-secondary);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-md);
  padding: var(--space-md);
  display: flex;
  flex-direction: column;
  min-width: 0; /* Allow shrinking in grid layouts */
}

.memory-slab-panel.critical {
  border-color: var(--color-warning);
}

/* Unified slab/pool header */
.slab-header,
.pool-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-sm);
}

/* Unified slab/pool name */
.slab-name,
.pool-name {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.slab-badge {
  font-size: 10px;
  padding: 2px 6px;
  border-radius: 4px;
  background: var(--bg-elevated);
  color: var(--text-muted);
}

.slab-badge.warning {
  background: var(--color-warning-bg);
  color: var(--color-warning);
}

/* ===== UNIFIED SLAB/POOL GRID STYLES ===== */
.slab-canvas,
.pool-grid-container {
  position: relative;
  overflow: hidden;
  min-width: 0; /* Allow shrinking in flex/grid containers */
}

.slab-grid {
  display: flex;
  background: var(--bg-primary);
  flex-wrap: wrap;
  gap: 1px;
  padding: 2px;
}

/* Canvas-based slab grid */
.slab-grid-canvas {
  display: block;
  border-radius: var(--radius-sm);
  background: var(--bg-tertiary); /* Shows through on incomplete last row */
}

/* pool-grid: container already has padding/bg, grid just needs flex layout */
.pool-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 1px;
}

.slab-cell {
  width: 5px;
  height: 5px;
  border-radius: 1px;
  transition: background-color 100ms ease-out;
}

.slab-cell.free {
  background: rgba(255, 255, 255, 0.25);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.slab-cell.used {
  background: var(--color-ok);
}

.slab-cell.flash {
  background: var(--color-warning);
  animation: slab-flash 300ms ease-out;
}

@keyframes slab-flash {
  0% { background: var(--color-warning); }
  100% { background: var(--color-ok); }
}

/* Connection state colors for handle slab */
.slab-cell.active {
  background: var(--color-ok);
}

.slab-cell.connecting {
  background: var(--color-info);
}

.slab-cell.idle {
  background: var(--color-info-muted);
}

.slab-cell.closing {
  background: var(--color-warning);
}

/* Non-connection handle types */
.slab-cell.tcp-listener {
  background: var(--color-purple);
}

.slab-cell.task {
  background: var(--color-cyan);
}

.slab-cell.timer {
  background: var(--color-warning-muted);
}

/* State summary legend in slab panels - uses unified legend styles */

/* ===== HANDLE TYPE BREAKDOWN (inline) ===== */
.handle-type-breakdown {
  display: flex;
  gap: var(--space-md);
  margin: var(--space-sm) 0;
  font-size: 11px;
}

.type-item {
  display: flex;
  align-items: center;
  gap: 4px;
}

.type-label {
  color: var(--text-muted);
}

.type-item.type-http .type-label { color: var(--color-ok); }
.type-item.type-tcp .type-label { color: var(--color-purple); }
.type-item.type-task .type-label { color: var(--color-cyan); }
.type-item.type-timer .type-label { color: var(--color-warning); }

.type-item span:last-child {
  font-weight: 600;
  font-family: 'SF Mono', Monaco, monospace;
  color: var(--text-secondary);
}

/* Breakdown section header */
.breakdown-header {
  font-size: 10px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: var(--space-xs);
}

/* ===== OWNER BREAKDOWN TABLE ===== */
.owner-breakdown {
  margin-top: var(--space-sm);
  padding-top: var(--space-sm);
  border-top: 1px dashed var(--border-muted);
}

/* Owner table: rows=servers/clients, cols=active/idle/closing */
.owner-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 11px;
  font-family: 'SF Mono', Monaco, monospace;
}

.owner-table th,
.owner-table td {
  padding: 6px 10px;
  text-align: left;
  border-bottom: 1px solid var(--border-muted);
}

.owner-table th {
  font-size: 10px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  background: var(--bg-elevated);
}

.owner-table .owner-name-col {
  width: auto;
}

.owner-table .state-col {
  text-align: center;
  width: 70px;
}

.owner-table .active-col { color: var(--color-ok); }
.owner-table .idle-col { color: var(--color-info); }
.owner-table .closing-col { color: var(--color-warning); }
.owner-table .total-col { color: var(--text-primary); width: 90px; }

.owner-table tbody tr:hover {
  background: var(--bg-hover);
}

.owner-table tbody tr:last-child td {
  border-bottom: none;
}

.owner-name-cell {
  color: var(--text-secondary);
  font-weight: 500;
}

.state-cell {
  text-align: center;
  font-weight: 600;
}

.active-cell { color: var(--color-ok); }
.idle-cell { color: var(--color-info); }
.closing-cell { color: var(--color-warning); }
.total-cell { color: var(--text-primary); }

.owner-pct {
  font-weight: 400;
  color: var(--text-muted);
  font-size: 10px;
}

.owner-count {
  font-weight: 600;
  color: var(--text-primary);
}

.slab-stats {
  margin-top: var(--space-sm);
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 11px;
  color: var(--text-muted);
}

.slab-stats .used-count {
  color: var(--color-ok);
  font-weight: 600;
}

.slab-stats .overflow-warning {
  color: var(--color-error);
  font-size: 10px;
}

/* Arena Gauges */
.memory-arena-section {
  background: var(--bg-secondary);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-md);
  padding: var(--space-md);
  margin-bottom: var(--space-lg);
}

.arena-title {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: var(--space-md);
}

/* (Arena gauge styles removed - now using PoolGauge widget) */

/* Additional legend dot variants */
.legend-dot.hwm {
  background: var(--color-warning);
  width: 2px;
  height: 12px;
}

/* SSE Connection Indicator */
.sse-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: var(--color-ok);
  animation: sse-pulse 2s infinite;
}

@keyframes sse-pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* Memory Legend Footer */
.memory-legend-footer {
  display: flex;
  justify-content: center;
  gap: var(--space-xl);
  margin-top: var(--space-xl);
  padding: var(--space-md);
  background: var(--bg-secondary);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-md);
}

/* ===== VM MEMORY CONSOLIDATED ===== */
.vm-memory-consolidated {
  display: flex;
  gap: var(--space-md);
  align-items: stretch;
}

.memory-block {
  background: var(--bg-secondary);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-md);
  overflow: hidden;
}

.memory-block-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-sm) var(--space-md);
  background: var(--bg-tertiary);
  border-bottom: 1px solid var(--border-default);
}

.memory-block-title {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  font-size: 13px;
  font-weight: 600;
  color: var(--text-primary);
}

.memory-icon {
  width: 24px;
  height: 24px;
  border-radius: var(--radius-sm);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  font-weight: 700;
}

.memory-icon.gc {
  background: var(--color-ok-bg);
  color: var(--color-ok);
}

.memory-icon.arena {
  background: var(--color-ok-bg);
  color: var(--color-ok);
}

.memory-block-summary {
  font-size: 12px;
  color: var(--text-muted);
}

.memory-block-summary .usage-pct {
  font-weight: 600;
  color: var(--text-primary);
}

.memory-block-summary .usage-detail {
  color: var(--text-faint);
  margin-left: var(--space-xs);
}

.memory-block-body {
  padding: var(--space-sm) var(--space-md);
}

.slab-with-legend {
  display: flex;
  flex-direction: column;
  gap: var(--space-sm);
}

.slab-with-legend .memory-slab-panel {
  margin-bottom: 0;
  border: none;
  background: transparent;
  padding: 0;
}

/* Inline Memory Legend - uses unified legend styles */

/* Slab type badge */
.slab-type-badge {
  font-size: 9px;
  padding: 1px 4px;
  border-radius: 3px;
  background: var(--color-purple-bg);
  color: var(--color-purple);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-left: var(--space-xs);
}

/* Tiered heap container (PoolGauge widgets are injected here) */
.heap-tiers {
  display: flex;
  flex-direction: column;
  gap: var(--space-sm);
}

/* (Tier bar, heap legend, and tier stats styles removed - now using PoolGauge widget) */

/* Heap aggregate stats */
.heap-aggregate {
  margin-top: var(--space-md);
  padding-top: var(--space-md);
  border-top: 1px solid var(--border-muted);
}

.heap-aggregate-row {
  display: flex;
  align-items: baseline;
  gap: var(--space-xs);
  font-size: 11px;
  color: var(--text-muted);
}

.agg-label {
  text-transform: lowercase;
}

.agg-value {
  font-family: var(--font-mono);
  color: var(--text-secondary);
}

.agg-unit {
  font-family: var(--font-mono);
  color: var(--text-muted);
  font-size: 10px;
}

.agg-sep {
  margin: 0 var(--space-sm);
  color: var(--border-muted);
}

/* ==================== PoolWidget ====================
 * Unified pool/slab visualization combining gauge bar, canvas grid, and legend.
 * Variants: full, compact, mini, gauge-only
 * Presets: slab (cyan), malloc (orange), arena (green), buffer (purple), queue (blue)
 */
.pool-widget {
  --pool-color: var(--color-ok);
  --pool-color-muted: var(--color-ok-muted);
  --pool-hwm-color: var(--color-info);
  --pool-threshold-color: var(--color-error);

  display: flex;
  flex-direction: column;
  gap: var(--space-xs);
  padding: var(--space-sm);
  padding-bottom: var(--space-lg);
  background: var(--bg-tertiary);
  border-radius: var(--radius-md);
}

/* Preset colors */
.pool-widget.slab {
  --pool-color: var(--color-cyan);
  --pool-color-muted: var(--color-cyan-muted);
}

.pool-widget.malloc {
  --pool-color: var(--color-warning);
  --pool-color-muted: var(--color-warning-muted);
}

.pool-widget.arena {
  --pool-color: var(--color-ok);
  --pool-color-muted: var(--color-ok-muted);
}

.pool-widget.buffer {
  --pool-color: var(--color-purple);
  --pool-color-muted: var(--color-purple-muted);
}

.pool-widget.queue {
  --pool-color: var(--color-info);
  --pool-color-muted: var(--color-info-muted);
}

/* Variant: compact */
.pool-widget.compact {
  padding: var(--space-xs) var(--space-sm);
  gap: var(--space-xs);
}

/* Variant: mini */
.pool-widget.mini {
  padding: var(--space-xs);
  gap: 2px;
}

/* Variant: gauge-only */
.pool-widget.gauge-only {
  padding: var(--space-xs) var(--space-sm);
}

/* Header */
.pool-widget-header {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
}

.pool-widget-icon {
  width: 18px;
  height: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  font-weight: 600;
  border-radius: var(--radius-sm);
  background: color-mix(in srgb, var(--pool-color) 20%, transparent);
  color: var(--pool-color);
  flex-shrink: 0;
}

.pool-widget-name {
  font-size: 11px;
  font-weight: 500;
  color: var(--text-primary);
  flex: 1;
  min-width: 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.pool-widget-usage {
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--text-secondary);
  flex-shrink: 0;
}

.pool-widget-badge {
  font-size: 10px;
  font-family: var(--font-mono);
  padding: 1px 4px;
  border-radius: 3px;
  background: color-mix(in srgb, var(--pool-color) 20%, transparent);
  color: var(--pool-color);
  flex-shrink: 0;
}

.pool-widget-badge.warning {
  background: var(--color-warning-bg);
  color: var(--color-warning);
}

.pool-widget-badge.critical {
  background: var(--color-error-bg);
  color: var(--color-error);
}

/* Gauge track and fill */
.pool-widget-gauge {
  position: relative;
  height: 10px;
  background: var(--bg-primary);
  border-radius: 5px;
  overflow: visible;
}

.pool-widget.compact .pool-widget-gauge,
.pool-widget.mini .pool-widget-gauge {
  height: 8px;
  border-radius: 4px;
}

.pool-widget-fill {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  border-radius: inherit;
  transition: width 0.3s ease, background 0.3s ease;
  background: linear-gradient(90deg, var(--pool-color) 0%, var(--pool-color-muted) 100%);
}

.pool-widget-fill.warning {
  background: linear-gradient(90deg, var(--color-warning) 0%, var(--color-warning-muted) 100%);
}

.pool-widget-fill.critical {
  background: linear-gradient(90deg, var(--color-error) 0%, color-mix(in srgb, var(--color-error) 80%, #ff4444) 100%);
}

/* Minimap canvas in gauge - shows compressed memory view */
.pool-widget-gauge.has-minimap {
  overflow: visible;
  height: 14px;
  padding: 2px;
  border: 1px solid var(--border-secondary);
  border-radius: 6px;
  background: var(--bg-primary);
}

.pool-widget-minimap {
  position: relative;
  display: block;
  width: 100%;
  height: 100%;
  border-radius: 3px;
  z-index: 0;
}

/* Fill becomes a glowing border overlay tracking percentage */
.pool-widget-gauge.has-minimap .pool-widget-fill {
  position: absolute;
  top: -1px;
  left: -1px;
  bottom: -1px;
  height: auto;
  background: transparent;
  border: 1px solid var(--pool-color);
  border-right: none;
  border-radius: 6px 0 0 6px;
  box-shadow: 0 0 8px color-mix(in srgb, var(--pool-color) 60%, transparent),
              0 0 16px color-mix(in srgb, var(--pool-color) 30%, transparent),
              inset -4px 0 8px -4px color-mix(in srgb, var(--pool-color) 80%, transparent);
  pointer-events: none;
  z-index: 1;
}

.pool-widget-gauge.has-minimap .pool-widget-fill.warning {
  border-color: var(--color-warning);
  box-shadow: 0 0 8px color-mix(in srgb, var(--color-warning) 60%, transparent),
              0 0 16px color-mix(in srgb, var(--color-warning) 30%, transparent),
              inset -4px 0 8px -4px color-mix(in srgb, var(--color-warning) 80%, transparent);
}

.pool-widget-gauge.has-minimap .pool-widget-fill.critical {
  border-color: var(--color-error);
  box-shadow: 0 0 10px color-mix(in srgb, var(--color-error) 70%, transparent),
              0 0 20px color-mix(in srgb, var(--color-error) 40%, transparent),
              inset -4px 0 8px -4px color-mix(in srgb, var(--color-error) 90%, transparent);
}

/* Adjust markers for minimap gauge */
.pool-widget-gauge.has-minimap .pool-widget-markers {
  z-index: 2;
}

.pool-widget-gauge.has-minimap .pool-widget-marker {
  top: -4px;
  bottom: -4px;
}

/* Markers */
.pool-widget-markers {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

.pool-widget-marker {
  position: absolute;
  top: -3px;
  bottom: -3px;
  width: 2px;
  transform: translateX(-50%);
  z-index: 2;
}

.pool-widget-marker.hwm {
  background: var(--pool-hwm-color);
}

.pool-widget-marker.hwm::after {
  content: attr(data-label);
  position: absolute;
  top: calc(100% + 6px);
  left: 50%;
  transform: translateX(-50%);
  font-size: 9px;
  font-family: var(--font-mono);
  color: var(--pool-hwm-color);
  white-space: nowrap;
  background: var(--bg-primary);
  padding: 2px 6px;
  border-radius: 3px;
  border: 1px solid var(--pool-hwm-color);
  opacity: 0;
  transition: opacity 0.2s;
  z-index: 10;
  pointer-events: none;
}

/* Show marker tooltips only when hovering the gauge area, not the full grid */
.pool-widget-gauge:hover .pool-widget-marker.hwm::after {
  opacity: 1;
}

.pool-widget-marker.threshold {
  background: var(--pool-threshold-color);
}

.pool-widget-marker.threshold::after {
  content: attr(data-label);
  position: absolute;
  top: calc(100% + 6px);
  left: 50%;
  transform: translateX(-50%);
  font-size: 9px;
  font-family: var(--font-mono);
  color: var(--pool-threshold-color);
  white-space: nowrap;
  background: var(--bg-primary);
  padding: 2px 6px;
  border-radius: 3px;
  border: 1px solid var(--pool-threshold-color);
  opacity: 0;
  transition: opacity 0.2s;
  z-index: 10;
  pointer-events: none;
}

.pool-widget-gauge:hover .pool-widget-marker.threshold::after {
  opacity: 1;
}

.pool-widget-marker.custom {
  background: var(--text-muted);
}

/* Canvas grid */
.pool-widget-grid {
  min-height: 20px;
}

.pool-widget-canvas {
  display: block;
  width: 100%;
  border-radius: var(--radius-sm);
}

.pool-widget.compact .pool-widget-grid {
  min-height: 16px;
}

.pool-widget.mini .pool-widget-grid {
  min-height: 12px;
}

/* Stats row */
.pool-widget-stats {
  display: flex;
  gap: var(--space-md);
  flex-wrap: wrap;
}

.pool-widget-stat {
  display: flex;
  align-items: baseline;
  gap: 2px;
  font-size: 10px;
}

.pool-widget-stat .label {
  color: var(--text-muted);
}

.pool-widget-stat .value {
  font-family: var(--font-mono);
  color: var(--text-primary);
}

/* Legend */
.pool-widget-legend {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-sm) var(--space-md);
  font-size: 10px;
  color: var(--text-secondary);
  padding-top: var(--space-xs);
  border-top: 1px solid var(--border-primary);
}

.pool-widget.compact .pool-widget-legend,
.pool-widget.mini .pool-widget-legend {
  font-size: 9px;
  gap: var(--space-xs) var(--space-sm);
}

.pool-widget-legend-item {
  display: flex;
  align-items: center;
  gap: 4px;
}

.pool-widget-legend-bar {
  width: 12px;
  height: 6px;
  border-radius: 2px;
  background: var(--pool-color);
}

.pool-widget-legend-marker {
  width: 2px;
  height: 10px;
  border-radius: 1px;
}

.pool-widget-legend-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
}

/* ==================== Size Class Stats (Memory Section) ==================== */
.heap-size-class-stats {
  margin-top: var(--space-sm);
  padding-top: var(--space-sm);
  border-top: 1px solid var(--border-subtle);
}

.size-class-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-sm);
}

.size-class-title {
  font-size: 11px;
  font-weight: 600;
  color: var(--text-secondary);
}

.size-class-large {
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--text-muted);
}

.size-class-bars {
  display: flex;
  gap: 3px;
  height: 40px;
  padding: var(--space-xs);
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
}

.size-class-bar-item {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-end;
  min-width: 0;
}

.size-class-bar-fill {
  width: 100%;
  background: var(--color-info);
  border-radius: 2px 2px 0 0;
  min-height: 2px;
  transition: height 0.3s ease;
}

.size-class-bar-label {
  font-size: 8px;
  color: var(--text-faint);
  margin-top: 2px;
  white-space: nowrap;
}

/* Legacy fragmentation stats (kept for backwards compat) */
.heap-fragmentation-stats {
  margin-top: var(--space-sm);
  padding-top: var(--space-sm);
  border-top: 1px solid var(--border-subtle);
  display: none; /* Hidden - replaced by size class stats */
}

/* Full variant with all sections */
.pool-widget.full {
  padding: var(--space-md);
  gap: var(--space-sm);
}

.pool-widget.full .pool-widget-header {
  margin-bottom: var(--space-xs);
}

.pool-widget.full .pool-widget-icon {
  width: 22px;
  height: 22px;
  font-size: 11px;
}

.pool-widget.full .pool-widget-name {
  font-size: 12px;
}

/* Collapsible grid feature */
.pool-widget-toggle {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  padding: 0;
  border: none;
  background: transparent;
  color: var(--text-muted);
  cursor: pointer;
  border-radius: var(--radius-sm);
  transition: background 0.15s, color 0.15s;
  flex-shrink: 0;
  margin-right: var(--space-xs);
}

.pool-widget-toggle:hover:not(.disabled) {
  background: var(--bg-secondary);
  color: var(--text-primary);
}

.pool-widget-toggle.disabled {
  opacity: 0.3;
  cursor: default;
}

.pool-widget-toggle:focus-visible {
  outline: 2px solid var(--color-info);
  outline-offset: 1px;
}

.pool-widget-toggle .toggle-chevron {
  transition: transform 0.2s ease;
}

.pool-widget-toggle[aria-expanded="false"] .toggle-chevron {
  transform: rotate(-90deg);
}

.pool-widget-toggle[aria-expanded="true"] .toggle-chevron {
  transform: rotate(0deg);
}

/* Trend indicator (for non-slab allocators like malloc) */
.pool-widget-trend {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  font-size: 10px;
  color: var(--text-muted);
  flex-shrink: 0;
  margin-right: var(--space-xs);
  transition: color 0.2s ease;
}

.pool-widget-trend.up {
  color: var(--color-warning);
}

.pool-widget-trend.down {
  color: var(--color-ok);
}

.pool-widget-trend.stable {
  color: var(--text-muted);
}

/* Grid wrapper for collapse animation */
.pool-widget-grid-wrapper {
  display: grid;
  grid-template-rows: 1fr;
  transition: grid-template-rows 0.2s ease, opacity 0.15s ease, margin 0.2s ease;
  overflow: hidden;
  margin-top: var(--space-md);
}

.pool-widget-grid-wrapper.collapsed {
  grid-template-rows: 0fr;
  opacity: 0;
  margin-top: 0;
}

.pool-widget-grid-wrapper > .pool-widget-grid {
  min-height: 0;
}

/* Arenas block - dynamic arena widgets */
.arenas-block {
  flex: 0 0 auto;
  min-width: 200px;
}

.arenas-block .memory-block-header {
  padding: var(--space-xs) var(--space-sm);
}

.arenas-block .memory-block-title {
  font-size: 11px;
}

.arenas-block .memory-icon {
  width: 18px;
  height: 18px;
  font-size: 9px;
}

.arenas-block .memory-block-body {
  padding: var(--space-xs) var(--space-sm);
}

.arena-tiers {
  display: flex;
  flex-direction: column;
  gap: var(--space-xs);
}

/* GC heap block takes remaining space */
.gc-heap-block {
  flex: 1;
  min-width: 0;
}

/* ===== COLLAPSIBLE SERVER CARDS ===== */
.entity-card.collapsed .entity-body {
  display: none;
}

.entity-card .expand-toggle {
  background: none;
  border: none;
  color: var(--text-muted);
  cursor: pointer;
  padding: var(--space-xs);
  margin-left: auto;
  transition: transform 0.2s;
  font-size: 12px;
}

.entity-card .expand-toggle:hover {
  color: var(--text-primary);
}

.entity-card.collapsed .expand-toggle {
  transform: rotate(-90deg);
}

/* ===== COLLAPSIBLE PANELS ===== */
.panel-header {
  cursor: pointer;
  user-select: none;
}

.panel-header:hover {
  background: var(--bg-elevated);
}

.panel-header .expand-icon {
  margin-left: auto;
  font-size: 10px;
  color: var(--text-muted);
  transition: transform 0.2s ease;
}

.panel.collapsed .panel-header .expand-icon {
  transform: rotate(-90deg);
}

.panel.collapsed .panel-body {
  display: none;
}

.panel-summary {
  display: none;
  font-size: 11px;
  color: var(--text-muted);
  margin-left: var(--space-sm);
}

.panel.collapsed .panel-summary {
  display: inline;
}

/* ===== INLINE METRICS ROW ===== */
.metrics-inline {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-xs) var(--space-lg);
  font-size: 12px;
  padding: var(--space-sm) 0;
}

.metric-inline {
  display: inline-flex;
  align-items: center;
  gap: var(--space-xs);
  white-space: nowrap;
}

.metric-inline-label {
  color: var(--text-muted);
}

.metric-inline-value {
  color: var(--text-primary);
  font-weight: 600;
  font-variant-numeric: tabular-nums;
}

.metric-inline-sep {
  color: var(--border-default);
  margin: 0 var(--space-xs);
}

/* ===== CUSTOM TOOLTIP COMPONENT ===== */
.has-tooltip {
  position: relative;
}

.tooltip {
  visibility: hidden;
  opacity: 0;
  position: absolute;
  bottom: calc(100% + 8px);
  left: 50%;
  transform: translateX(-50%);
  background: var(--bg-elevated);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-md);
  padding: var(--space-sm) var(--space-md);
  font-size: 12px;
  line-height: 1.5;
  color: var(--text-secondary);
  max-width: 300px;
  white-space: normal;
  z-index: 1000;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
  transition: opacity 0.15s, visibility 0.15s;
  pointer-events: none;
}

.tooltip::after {
  content: '';
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  border: 6px solid transparent;
  border-top-color: var(--border-default);
}

.has-tooltip:hover .tooltip,
.has-tooltip:focus-within .tooltip {
  visibility: visible;
  opacity: 1;
}

.tooltip-title {
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: var(--space-xs);
}

.tooltip-body {
  color: var(--text-muted);
}

/* ===== LOADING STATES ===== */
@keyframes skeleton-pulse {
  0%, 100% { opacity: 0.4; }
  50% { opacity: 0.7; }
}

.skeleton {
  background: linear-gradient(90deg, var(--bg-tertiary) 0%, var(--bg-elevated) 50%, var(--bg-tertiary) 100%);
  background-size: 200% 100%;
  animation: skeleton-pulse 1.5s ease-in-out infinite;
  border-radius: var(--radius-sm);
}

.health-card-value.loading {
  color: transparent;
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
  animation: skeleton-pulse 1.5s ease-in-out infinite;
}

/* ===== STAGGERED CARD ANIMATIONS ===== */
@keyframes card-enter {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.entity-card {
  animation: card-enter 0.3s ease-out backwards;
}

.entity-card:nth-child(1) { animation-delay: 0ms; }
.entity-card:nth-child(2) { animation-delay: 50ms; }
.entity-card:nth-child(3) { animation-delay: 100ms; }
.entity-card:nth-child(4) { animation-delay: 150ms; }
.entity-card:nth-child(5) { animation-delay: 200ms; }
.entity-card:nth-child(6) { animation-delay: 250ms; }

/* ===== SMOOTH STATUS TRANSITIONS ===== */
.entity-status {
  transition: background-color 0.3s ease, box-shadow 0.3s ease;
}

.entity-status.ok {
  box-shadow: 0 0 8px var(--color-ok-bg);
}

.entity-status.warning {
  box-shadow: 0 0 8px var(--color-warning-bg);
}

.entity-status.error {
  box-shadow: 0 0 8px var(--color-error-bg);
}

/* ===== VALUE UPDATE FLASH ===== */
@keyframes value-update {
  0% { background-color: var(--color-info-bg); }
  100% { background-color: transparent; }
}

.value-updated {
  animation: value-update 0.5s ease-out;
}

/* ===== EXPANDED AIO SYSTEM PANELS ===== */
.aio-system-panel.aio-expanded {
  grid-column: span 2;  /* Take full width */
}

.aio-system-panel .panel-badges {
  display: flex;
  gap: var(--space-sm);
  align-items: center;
  margin-left: auto;
}

.aio-system-panel .panel-body {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(min(420px, 100%), 1fr));
  gap: var(--space-md);
  padding: var(--space-md);
  overflow: hidden;
}

/* ===== AIO SECTION BLOCKS (Phase 2) ===== */
.aio-section-block {
  padding: var(--space-md);
  background: var(--bg-tertiary);
  border-radius: var(--radius-md);
  border: 1px solid var(--border-muted);
  min-width: 0;  /* Allow shrinking below content size in grid */
  overflow: hidden;
}

/* Network/IO sections span full width below event-loop and memory */
.http-servers-section,
.http-clients-section,
.tcp-servers-section,
.tcp-clients-section,
.udp-section,
.file-ops-section {
  grid-column: 1 / -1;
}

.block-header {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  margin-bottom: var(--space-sm);
  padding-bottom: var(--space-xs);
  border-bottom: 1px dashed var(--border-muted);
}

.block-title {
  font-size: 11px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.block-badge {
  font-size: 11px;
  padding: 2px 8px;
  border-radius: 999px;
  background: var(--bg-elevated);
  color: var(--text-muted);
  margin-left: auto;
}

.block-badge + .block-badge {
  margin-left: var(--space-sm);
}

/* ===== EVENT LOOP COMPACT ===== */
.event-loop-block,
.memory-section-block {
  grid-column: 1 / -1;  /* Span full width */
}

.event-loop-block {
  padding: var(--space-md) var(--space-lg);
}

.event-loop-compact {
  display: flex;
  flex-direction: column;
  gap: var(--space-sm);
}

.event-loop-header {
  display: flex;
  align-items: center;
  gap: var(--space-md);
}

.event-loop-pulse {
  display: flex;
  gap: 3px;
  align-items: center;
}

.pulse-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: var(--bg-tertiary);
  border: 1px solid var(--border-muted);
  transition: background 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease, opacity 0.3s ease;
}

.pulse-dot.active {
  background: var(--color-cyan);
  border-color: var(--color-cyan);
  box-shadow: 0 0 6px var(--color-cyan);
  animation: pulse-glow 1.5s ease-in-out infinite;
}

@keyframes pulse-glow {
  0%, 100% { opacity: 0.7; }
  50% { opacity: 1; }
}

.event-loop-metrics {
  display: flex;
  align-items: center;
  gap: var(--space-md);
  font-size: 12px;
  flex-wrap: wrap;
}

.event-loop-util {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
}

.util-bar {
  width: 60px;
  height: 8px;
  background: var(--bg-tertiary);
  border-radius: 4px;
  overflow: hidden;
  border: 1px solid var(--border-muted);
}

.util-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--color-cyan), var(--color-info));
  border-radius: 3px;
  transition: width 0.3s ease, background 0.3s ease;
}

.util-fill.high {
  background: linear-gradient(90deg, var(--color-warning), var(--color-warning-bright, #ffb347));
}

.util-fill.critical {
  background: linear-gradient(90deg, var(--color-error), var(--color-error-bright, #ff6b6b));
}

.util-label {
  color: var(--text-muted);
  font-family: var(--font-mono);
  font-size: 11px;
  min-width: 55px;
}

.util-label span {
  color: var(--text-primary);
  font-weight: 600;
}

.metric-sep {
  color: var(--border-muted);
  font-size: 10px;
}

.event-loop-metric {
  display: inline-flex;
  align-items: baseline;
  gap: 3px;
}

.event-loop-metric .metric-value {
  font-family: var(--font-mono);
  font-weight: 600;
  color: var(--text-primary);
}

.event-loop-metric .metric-unit {
  font-size: 10px;
  color: var(--text-muted);
}

.queue-metric.warning .metric-value {
  color: var(--color-warning);
}

.queue-metric.critical .metric-value {
  color: var(--color-error);
  animation: blink 0.5s ease-in-out infinite;
}

@keyframes blink {
  50% { opacity: 0.5; }
}

/* Responsive: stack on mobile */
@media (max-width: 500px) {
  .event-loop-metrics {
    flex-direction: column;
    align-items: flex-start;
    gap: var(--space-xs);
  }

  .metric-sep {
    display: none;
  }
}

/* ===== NESTED CARDS GRID ===== */
/* Responsive grid - fills space with multiple columns when available */
.nested-cards-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(min(380px, 100%), 1fr));
  gap: var(--space-md);
  min-width: 0;
  overflow: hidden;
}

.nested-cards-grid .entity-card {
  margin: 0;
  background: var(--bg-secondary);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-md);
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
  min-width: 0;  /* Allow shrinking in grid cell */
}

.nested-cards-grid .entity-header {
  padding: var(--space-sm) var(--space-md);
  background: var(--bg-tertiary);
  min-width: 0;
  overflow: hidden;
}

.nested-cards-grid .entity-body {
  padding: var(--space-md);
  min-width: 0;
  overflow: hidden;
}

.nested-cards-grid .entity-name {
  font-size: 12px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  min-width: 0;
  flex-shrink: 1;
}


/* ===== RESOURCE POOL PANEL (extends memory-slab-panel) ===== */
.resource-pool-panel {
  background: var(--bg-tertiary);
  border-color: var(--border-muted);
  margin-bottom: var(--space-md);
}

/* pool-header uses slab-header, pool-name uses slab-name */
.resource-pool-panel .pool-usage {
  font-variant-numeric: tabular-nums;
}

/* pool-grid-container extends slab-canvas */
.pool-grid-container {
  margin-bottom: var(--space-sm);
}

/* ===== POOL BREAKDOWN (State + Owner) ===== */
.pool-breakdown {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: var(--space-lg);
  padding-top: var(--space-sm);
  border-top: 1px dashed var(--border-muted);
}

/* breakdown-by-state uses unified legend styles */

.breakdown-by-owner,
.pool-breakdown .owner-breakdown {
  flex: 1;
  max-width: 50%;
  padding: 0;
  border-top: none;
  margin-top: 0;
}

/* Owner breakdown bar chart */
.owner-bar-chart {
  display: flex;
  height: 14px;
  background: var(--bg-elevated);
  border-radius: var(--radius-sm);
  overflow: hidden;
  margin-bottom: 4px;
}

.owner-bar-segment {
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 4px;
  font-size: 9px;
  font-weight: 600;
  color: white;
  transition: width 0.3s ease;
}

/* owner-bar-legend extends unified legend styles */
.owner-bar-legend {
  flex-wrap: wrap;
  gap: 4px 8px;
  font-size: 10px;
}

.owner-bar-legend .legend-dot {
  width: 6px;
  height: 6px;
}

.owner-bar-legend .owner-label {
  font-family: 'SF Mono', Monaco, monospace;
  font-size: 9px;
}

.owner-bar-legend .owner-count {
  color: var(--text-secondary);
  font-weight: 500;
}

/* Pool warnings */
.pool-warnings {
  margin-top: var(--space-xs);
  font-size: 11px;
}

.pool-warnings .capacity-warning,
.pool-warnings .overflow-warning {
  color: var(--color-warning);
  padding: 2px 6px;
  background: var(--color-warning-bg);
  border-radius: var(--radius-sm);
  margin-right: var(--space-sm);
}

.pool-warnings .overflow-warning {
  color: var(--color-error);
  background: var(--color-error-bg);
}

/* Event loop stats row (legacy, keeping for backwards compatibility) */
.aio-stats-row {
  padding-bottom: var(--space-md);
  border-bottom: 1px solid var(--border-muted);
}

/* Resource sections within AIO panel */
.aio-resource-section {
  display: flex;
  flex-direction: column;
  gap: var(--space-md);
}

.aio-subsection-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.aio-subsection-title {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* Library memory stats row (SSL + nghttp2) */
.aio-lib-memory-stats {
  display: flex;
  gap: var(--space-lg);
  padding: var(--space-sm) var(--space-md);
  background: var(--bg-secondary);
  border-radius: var(--radius-sm);
  margin-bottom: var(--space-md);
  font-family: var(--font-mono);
  font-size: var(--font-xs);
}

.lib-mem-stat {
  display: flex;
  align-items: center;
  gap: var(--space-xs);
}

.lib-mem-icon {
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: var(--radius-sm);
  font-size: 10px;
  font-weight: 600;
  color: var(--text-primary);
}

.lib-mem-icon.ssl {
  background: linear-gradient(135deg, #10b981 0%, #059669 100%);
}

.lib-mem-icon.http2 {
  background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
}

.lib-mem-icon.libuv {
  background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
}

.lib-mem-label {
  color: var(--text-muted);
}

.lib-mem-value {
  color: var(--text-primary);
  font-weight: 500;
}

.lib-mem-stat.lib-mem-total {
  margin-left: auto;
  padding-left: var(--space-md);
  border-left: 1px solid var(--border-color);
}

.lib-mem-stat.lib-mem-total .lib-mem-label {
  color: var(--text-secondary);
}

/* Slab grid layout within AIO panel */
.aio-slab-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--space-lg);
  margin-top: var(--space-sm);
}

/* Pool widgets inside AIO slab grid */
.aio-slab-grid .pool-widget {
  min-width: 0; /* Allow shrinking in grid */
}

.aio-slab-grid .pool-widget.compact {
  padding: var(--space-xs) var(--space-sm);
}

/* Compact slab panels inside AIO */
.memory-slab-panel.compact {
  padding: var(--space-sm);
}

.memory-slab-panel.compact .slab-header {
  margin-bottom: var(--space-xs);
}

.memory-slab-panel.compact .slab-name {
  font-size: 11px;
}

.memory-slab-panel.compact .slab-canvas {
  /* Let content determine height */
}

.memory-slab-panel.compact .slab-stats {
  font-size: 10px;
  margin-top: var(--space-xs);
}

/* (Queue gauge styles removed - now using PoolGauge widget) */

/* Mini slab panels for HTTP servers/clients */
.memory-slab-panel.mini {
  padding: var(--space-xs) var(--space-sm);
  flex-direction: row;
  align-items: center;
  gap: var(--space-sm);
}

.memory-slab-panel.mini .slab-header {
  margin-bottom: 0;
  min-width: 90px;
}

.memory-slab-panel.mini .slab-canvas {
  flex: 1;
}

.memory-slab-panel.mini .slab-grid {
  padding: 2px;
}

.memory-slab-panel.mini .slab-cell {
  aspect-ratio: 1;
  border-radius: 1px;
}

/* HTTP resources row */
.aio-http-resources {
  display: flex;
  gap: var(--space-md);
}

.aio-http-resources .memory-slab-panel {
  flex: 1;
}

/* Warning/critical badge colors */
.slab-badge.critical {
  background: var(--color-error-bg);
  color: var(--color-error);
}

/* ===== METRICS REGISTRY SECTION ===== */
.registry-content {
  background: var(--bg-secondary);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-lg);
  padding: var(--space-lg);
}

.registry-stats-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: var(--space-md);
  margin-bottom: var(--space-md);
}

.registry-stat-card {
  background: var(--bg-tertiary);
  border-radius: var(--radius-md);
  padding: var(--space-sm) var(--space-md);
}

.registry-stat-header {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  margin-bottom: var(--space-xs);
}

.registry-stat-icon {
  width: 18px;
  height: 18px;
  border-radius: var(--radius-sm);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 9px;
  font-weight: 700;
}

.registry-stat-icon.counter { background: var(--color-info-bg); color: var(--color-info); }
.registry-stat-icon.gauge { background: var(--color-ok-bg); color: var(--color-ok); }
.registry-stat-icon.histogram { background: var(--color-purple-bg); color: var(--color-purple); }
.registry-stat-icon.strings { background: var(--color-cyan-bg); color: var(--color-cyan); }

.registry-stat-label {
  font-size: 11px;
  color: var(--text-muted);
  font-weight: 500;
}

.registry-stat-bar {
  height: 4px;
  background: var(--bg-elevated);
  border-radius: 2px;
  overflow: hidden;
  margin-bottom: var(--space-xs);
}

.registry-stat-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--color-ok), var(--color-info));
  transition: width 200ms ease-out;
  border-radius: 2px;
}

.registry-stat-fill.warning {
  background: linear-gradient(90deg, var(--color-warning), var(--color-warning-muted));
}

.registry-stat-fill.critical {
  background: linear-gradient(90deg, var(--color-error), var(--color-error-muted));
}

.registry-stat-values {
  display: flex;
  align-items: baseline;
  gap: 2px;
  font-size: 11px;
  font-variant-numeric: tabular-nums;
}

.registry-stat-active {
  font-weight: 600;
  color: var(--text-primary);
}

.registry-stat-sep {
  color: var(--text-muted);
}

.registry-stat-capacity {
  color: var(--text-muted);
}

.registry-stat-detail {
  color: var(--text-faint);
  font-size: 10px;
  margin-left: var(--space-xs);
}

.registry-eviction-stats {
  display: flex;
  align-items: center;
  gap: var(--space-md);
  padding: var(--space-xs) var(--space-sm);
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
  font-size: 11px;
}

.registry-eviction-label {
  color: var(--text-muted);
}

.registry-eviction-value {
  font-weight: 600;
  color: var(--text-primary);
  font-variant-numeric: tabular-nums;
}

.registry-eviction-breakdown {
  color: var(--text-faint);
  font-variant-numeric: tabular-nums;
}

.registry-collect-time {
  margin-left: auto;
  color: var(--text-faint);
  font-variant-numeric: tabular-nums;
}

/* Responsive: Stack slab grids on narrow screens */
@media (max-width: 1200px) {
  .registry-stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }

  .aio-slab-grid {
    grid-template-columns: repeat(2, 1fr);
  }

  .pool-breakdown {
    flex-direction: column;
    gap: var(--space-sm);
  }

  .breakdown-by-owner {
    max-width: 100%;
  }
}

@media (max-width: 900px) {
  .aio-system-panel.aio-expanded {
    grid-column: span 1;
  }

  .aio-system-panel .panel-body {
    grid-template-columns: 1fr;
  }

  .aio-slab-grid {
    grid-template-columns: 1fr;
  }

  .aio-http-resources {
    flex-direction: column;
  }

  .block-header {
    flex-wrap: wrap;
  }

  .block-badge {
    margin-left: 0;
  }

  .breakdown-by-state {
    flex-wrap: wrap;
    gap: var(--space-sm);
  }
}

@media (max-width: 600px) {
  .aio-section-block {
    padding: var(--space-md);
  }

  .resource-pool-panel {
    padding: var(--space-sm);
  }
}

/* ============================================================================
   Process Memory Overview (integrated into Memory subsection)
   ============================================================================ */

/* Memory subsection header with process overview */
.memory-subsection-header {
  display: flex;
  align-items: center;
  gap: var(--space-md);
  flex-wrap: wrap;
}

.process-memory-overview {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  margin-left: auto;
}

.process-gauge-inline {
  width: 120px;
}

.process-gauge-bar {
  height: 6px;
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
  overflow: hidden;
}

.process-gauge-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--color-cyan), var(--color-warning));
  border-radius: var(--radius-sm);
  transition: width 0.3s ease;
  width: 0%;
}

.process-memory-stats {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: var(--font-xs);
  font-family: var(--font-mono);
  white-space: nowrap;
}

.process-stat {
  color: var(--text-muted);
}

.process-stat span {
  color: var(--text-primary);
  font-weight: 500;
}

.process-stat.rss-stat {
  display: inline-flex;
  align-items: center;
  gap: 4px;
}

.rss-spark {
  width: 48px;
  height: 16px;
  display: inline-block;
  vertical-align: middle;
}

.rss-spark svg {
  display: block;
  width: 100%;
  height: 100%;
}

.process-stat-sep {
  color: var(--border-color);
}

.breakdown-toggle {
  background: transparent;
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  color: var(--text-muted);
  cursor: pointer;
  padding: 2px 6px;
  font-size: var(--font-xs);
  transition: all 0.2s ease;
}

.breakdown-toggle:hover {
  background: var(--bg-tertiary);
  color: var(--text-primary);
}

.breakdown-toggle-icon {
  display: inline-block;
  transition: transform 0.2s ease;
}

.breakdown-toggle[aria-expanded="true"] .breakdown-toggle-icon {
  transform: rotate(180deg);
}

/* Collapsible breakdown panel */
.process-breakdown {
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  margin-bottom: var(--space-md);
  padding: var(--space-md);
}

.process-breakdown.collapsed {
  display: none;
}

/* Stacked bar */
.stacked-bar {
  display: flex;
  height: 20px;
  border-radius: var(--radius-sm);
  overflow: hidden;
  background: var(--bg-tertiary);
  margin-bottom: var(--space-md);
}

.stacked-segment {
  height: 100%;
  transition: width 0.3s ease;
  min-width: 0;
  position: relative;
  overflow: hidden;
}

.stacked-segment:first-child {
  border-radius: var(--radius-sm) 0 0 var(--radius-sm);
}

.stacked-segment:last-child {
  border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
}

/* Segment fill (used portion inside capacity) */
.segment-fill {
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  width: 0%;
  transition: width 0.3s ease;
}

/* Segment colors: striped = capacity (unfilled), solid = used (fill) */
.stacked-segment.runtime {
  background: repeating-linear-gradient(
    -45deg,
    rgba(59, 130, 246, 0.25),
    rgba(59, 130, 246, 0.25) 3px,
    transparent 3px,
    transparent 6px
  );
}
.stacked-segment.runtime .segment-fill { background: #3b82f6; }

.stacked-segment.aio {
  background: repeating-linear-gradient(
    -45deg,
    rgba(245, 158, 11, 0.25),
    rgba(245, 158, 11, 0.25) 3px,
    transparent 3px,
    transparent 6px
  );
}
.stacked-segment.aio .segment-fill { background: #f59e0b; }

.stacked-segment.metrics {
  background: repeating-linear-gradient(
    -45deg,
    rgba(168, 85, 247, 0.25),
    rgba(168, 85, 247, 0.25) 3px,
    transparent 3px,
    transparent 6px
  );
}
.stacked-segment.metrics .segment-fill { background: #a855f7; }

.stacked-segment.other {
  background: rgba(107, 114, 128, 0.25);
}
.stacked-segment.other .segment-fill { background: #6b7280; }

/* Legend */
.breakdown-legend {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-sm) var(--space-lg);
  margin-bottom: var(--space-sm);
}

.legend-item {
  display: flex;
  align-items: center;
  gap: var(--space-xs);
  font-size: var(--font-xs);
  font-family: var(--font-mono);
}

.legend-dot {
  width: 10px;
  height: 10px;
  border-radius: 2px;
  flex-shrink: 0;
  position: relative;
  overflow: hidden;
}

/* Striped backgrounds for legend dots (represents reserved/capacity - matches bar segments) */
.legend-dot.runtime {
  background: repeating-linear-gradient(-45deg, rgba(59, 130, 246, 0.35), rgba(59, 130, 246, 0.35) 1.5px, transparent 1.5px, transparent 3px);
}
.legend-dot.aio {
  background: repeating-linear-gradient(-45deg, rgba(245, 158, 11, 0.35), rgba(245, 158, 11, 0.35) 1.5px, transparent 1.5px, transparent 3px);
}
.legend-dot.metrics {
  background: repeating-linear-gradient(-45deg, rgba(168, 85, 247, 0.35), rgba(168, 85, 247, 0.35) 1.5px, transparent 1.5px, transparent 3px);
}
.legend-dot.other {
  background: repeating-linear-gradient(-45deg, rgba(107, 114, 128, 0.35), rgba(107, 114, 128, 0.35) 1.5px, transparent 1.5px, transparent 3px);
}

/* Fill element for diagonal split (represents used/resident) */
/* Fixed 50/50 diagonal from bottom-left to top-right: solid=upper-left, muted=lower-right */
.legend-dot-fill {
  position: absolute;
  inset: 0;
  border-radius: 2px;
  clip-path: polygon(0 0, 0 100%, 100% 0);
}

.legend-dot.runtime .legend-dot-fill { background: #3b82f6; }
.legend-dot.aio .legend-dot-fill { background: #f59e0b; }
.legend-dot.metrics .legend-dot-fill { background: #a855f7; }
.legend-dot.other .legend-dot-fill { background: #6b7280; }

.legend-label {
  color: var(--text-primary);
}

.legend-value {
  color: var(--text-primary);
  font-weight: 500;
}

.legend-cap {
  color: var(--text-muted);
}

.legend-cap span {
  color: var(--text-secondary);
}

.legend-pct {
  color: var(--text-muted);
}

/* Footer */
.breakdown-footer {
  display: flex;
  align-items: center;
  gap: var(--space-md);
  font-size: 11px;
  color: var(--text-muted);
  font-family: var(--font-mono);
  flex-wrap: wrap;
}

.breakdown-footer .sep {
  color: var(--border-color);
}

/* =====================================================================
   SMAPS BREAKDOWN - OS Memory Regions
   ===================================================================== */

.smaps-breakdown {
  margin-top: var(--space-lg);
  padding-top: var(--space-lg);
  border-top: 1px dashed var(--border-muted);
}

.smaps-header {
  display: flex;
  align-items: baseline;
  gap: var(--space-sm);
  margin-bottom: var(--space-md);
}

.smaps-title {
  font-size: 11px;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.smaps-subtitle {
  font-size: 10px;
  color: var(--text-muted);
  font-family: var(--font-mono);
}

.smaps-bar {
  display: flex;
  height: 16px;
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
  overflow: hidden;
  margin-bottom: var(--space-md);
}

.smaps-segment {
  height: 100%;
  min-width: 2px;
  transition: width 0.3s ease;
}

/* Smaps color scheme - distinct from app breakdown */
.smaps-segment.smaps-heap { background: #60a5fa; }   /* blue - malloc */
.smaps-segment.smaps-anon { background: #f59e0b; }   /* amber - mmap buffers */
.smaps-segment.smaps-file { background: #10b981; }   /* green - shared libs */
.smaps-segment.smaps-stack { background: #8b5cf6; }  /* purple - stacks */
.smaps-segment.smaps-uring { background: #ec4899; }  /* pink - io_uring */
.smaps-segment.smaps-other { background: #6b7280; }  /* gray - vdso etc */

.smaps-legend {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-sm) var(--space-lg);
}

.smaps-legend-item {
  display: flex;
  align-items: center;
  gap: var(--space-xs);
  font-size: 11px;
}

.smaps-dot {
  width: 8px;
  height: 8px;
  border-radius: 2px;
  flex-shrink: 0;
}

.smaps-dot.smaps-heap { background: #60a5fa; }
.smaps-dot.smaps-anon { background: #f59e0b; }
.smaps-dot.smaps-file { background: #10b981; }
.smaps-dot.smaps-stack { background: #8b5cf6; }
.smaps-dot.smaps-uring { background: #ec4899; }
.smaps-dot.smaps-other { background: #6b7280; }

.smaps-label {
  color: var(--text-muted);
  min-width: 45px;
}

.smaps-value {
  font-family: var(--font-mono);
  color: var(--text-secondary);
  font-weight: 500;
}

.smaps-regions {
  font-family: var(--font-mono);
  color: var(--text-muted);
  font-size: 10px;
}

/* Responsive */
@media (max-width: 768px) {
  .process-memory-overview {
    width: 100%;
    margin-top: var(--space-sm);
  }

  .process-gauge-inline {
    flex: 1;
  }

  .breakdown-legend {
    gap: var(--space-xs) var(--space-md);
  }

  .legend-item {
    font-size: 10px;
  }
}

/* ===== AGGREGATE HEALTH BAR ===== */
.aio-aggregate-health {
  display: flex;
  align-items: center;
  gap: var(--space-lg);
  padding: var(--space-sm) var(--space-lg);
  background: var(--bg-secondary);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-md);
  margin-bottom: var(--space-lg);
}

.aio-health-status {
  display: flex;
  gap: var(--space-lg);
}

.health-group {
  display: flex;
  align-items: center;
  gap: var(--space-xs);
  font-size: 12px;
  font-weight: 500;
}

.health-group.ok .health-icon { color: var(--color-ok); }
.health-group.warning .health-icon { color: var(--color-warning); }
.health-group.error .health-icon { color: var(--color-error); }

.health-count {
  font-weight: 600;
  font-variant-numeric: tabular-nums;
}

.aio-health-divider {
  width: 1px;
  height: 24px;
  background: var(--border-default);
}

.aio-health-metrics {
  display: flex;
  gap: var(--space-lg);
}

.aio-health-metric {
  display: flex;
  align-items: baseline;
  gap: var(--space-xs);
}

.aio-health-value {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
  font-variant-numeric: tabular-nums;
}

.aio-health-label {
  font-size: 11px;
  color: var(--text-muted);
}

/* Responsive: stack on narrow screens */
@media (max-width: 768px) {
  .aio-aggregate-health {
    flex-direction: column;
    align-items: flex-start;
    gap: var(--space-sm);
  }
  .aio-health-divider {
    width: 100%;
    height: 1px;
  }
}

/* ==================== PHASE 6: I/O TYPE SECTIONS ==================== */
.io-section {
  background: var(--bg-secondary);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-md);
  margin-bottom: var(--space-md);
  overflow: hidden;
}

.io-section-header {
  display: flex;
  align-items: center;
  gap: var(--space-md);
  padding: var(--space-sm) var(--space-md);
  background: var(--bg-tertiary);
  border-bottom: 1px solid var(--border-default);
  cursor: pointer;
  user-select: none;
}

.io-section-header:hover {
  background: var(--bg-elevated);
}

.io-section-icon {
  font-size: 14px;
}

.io-section-title {
  font-size: 11px;
  font-weight: 600;
  letter-spacing: 0.5px;
  color: var(--text-muted);
}

.io-section-stats {
  margin-left: auto;
  font-size: 12px;
  color: var(--text-secondary);
}

.io-section-ops {
  font-weight: 600;
  font-variant-numeric: tabular-nums;
  color: var(--text-primary);
}

.io-section-toggle {
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 16px;
  cursor: pointer;
  padding: 0 var(--space-xs);
}

.io-section.collapsed .io-section-body {
  display: none;
}

.io-section.collapsed .toggle-icon {
  transform: rotate(0deg);
}

.io-section:not(.collapsed) .toggle-icon::before {
  content: '';
}

.io-section.collapsed .toggle-icon::before {
  content: '+';
}

.io-section-body {
  padding: var(--space-md);
}

/* Subsections */
.io-subsection {
  margin-bottom: var(--space-md);
}

.io-subsection:last-child {
  margin-bottom: 0;
}

.io-subsection-header {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  margin-bottom: var(--space-sm);
}

.io-subsection-title {
  font-size: 12px;
  font-weight: 500;
  color: var(--text-secondary);
}

.io-subsection-count {
  font-size: 11px;
  color: var(--text-muted);
}

.io-subsection-content {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: var(--space-md);
}

/* ==================== PHASE 7: NEW I/O TYPE CARDS ==================== */

/* TCP Server/Client Cards */
.tcp-conn-stats {
  display: flex;
  gap: var(--space-lg);
  padding: var(--space-sm) 0;
}

.tcp-stat {
  font-size: 12px;
  color: var(--text-secondary);
}

.tcp-stat .active-count,
.tcp-stat .idle-count,
.tcp-stat .closing-count {
  font-weight: 600;
  font-variant-numeric: tabular-nums;
  color: var(--text-primary);
  margin-left: var(--space-xs);
}

.tcp-throughput-stats {
  display: flex;
  gap: var(--space-lg);
  font-size: 11px;
  color: var(--text-secondary);
  margin-top: var(--space-sm);
}

.tcp-throughput-stats .bytes-in,
.tcp-throughput-stats .bytes-out {
  font-family: var(--font-mono);
  font-weight: 600;
  color: var(--text-primary);
}

.tcp-pool-bar {
  height: 8px;
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
  overflow: hidden;
  margin-bottom: var(--space-sm);
}

.tcp-pool-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--color-info), var(--color-cyan));
  transition: width 0.3s ease;
}

.tcp-pool-stats {
  font-size: 11px;
  color: var(--text-muted);
}

.tcp-pool-stats .pool-active,
.tcp-pool-stats .pool-max {
  font-family: var(--font-mono);
  font-weight: 600;
  color: var(--text-secondary);
}

.tcp-latency-stats {
  display: flex;
  gap: var(--space-lg);
  font-size: 11px;
  color: var(--text-muted);
  margin-bottom: var(--space-sm);
}

.tcp-latency-stats .p50,
.tcp-latency-stats .p99 {
  font-family: var(--font-mono);
  font-weight: 600;
  color: var(--text-primary);
}

/* UDP Socket Cards */
.udp-stats-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: var(--space-md);
}

.udp-stat {
  text-align: center;
  padding: var(--space-sm);
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
}

.udp-stat-value {
  font-size: 18px;
  font-weight: 600;
  font-variant-numeric: tabular-nums;
  color: var(--text-primary);
  margin-bottom: var(--space-xs);
}

.udp-stat-label {
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--text-muted);
}

.udp-stat .dropped {
  color: var(--color-warning);
}

/* File I/O Cards */
.file-io-grid {
  display: flex;
  flex-direction: column;
  gap: var(--space-sm);
}

.file-io-row {
  display: grid;
  grid-template-columns: 60px 80px 1fr 100px 120px;
  gap: var(--space-md);
  align-items: center;
  padding: var(--space-sm);
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
}

.file-io-label {
  font-size: 11px;
  font-weight: 600;
  color: var(--text-secondary);
}

.file-io-rate {
  font-family: var(--font-mono);
  font-size: 12px;
  font-weight: 600;
  color: var(--text-primary);
  font-variant-numeric: tabular-nums;
}

.file-io-spark {
  height: 24px;
  min-width: 60px;
}

.file-io-throughput {
  font-family: var(--font-mono);
  font-size: 11px;
  color: var(--text-secondary);
  font-variant-numeric: tabular-nums;
}

.file-io-latency {
  font-size: 11px;
  color: var(--text-muted);
}

.file-io-latency span {
  font-family: var(--font-mono);
  font-weight: 600;
  color: var(--text-secondary);
}

.file-io-pending {
  font-size: 11px;
  color: var(--text-muted);
  margin-top: var(--space-md);
  padding-top: var(--space-md);
  border-top: 1px solid var(--border-default);
}

.file-io-pending span {
  font-family: var(--font-mono);
  font-weight: 600;
  color: var(--text-secondary);
}

/* Unix Socket Cards */
.unix-socket-stats {
  display: flex;
  gap: var(--space-lg);
  font-size: 12px;
  color: var(--text-muted);
}

.unix-socket-stats span span {
  font-family: var(--font-mono);
  font-weight: 600;
  color: var(--text-primary);
}

/* Named Pipe Cards */
.pipe-throughput {
  display: flex;
  flex-direction: column;
  gap: var(--space-sm);
}

.pipe-rate {
  font-family: var(--font-mono);
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
  font-variant-numeric: tabular-nums;
}

.pipe-buffer-bar {
  height: 12px;
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
  overflow: hidden;
  margin-bottom: var(--space-xs);
}

.pipe-buffer-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--color-ok), var(--color-warning));
  transition: width 0.3s ease;
}

.pipe-buffer-label {
  font-size: 11px;
  color: var(--text-muted);
}

.pipe-buffer-label .buffer-pct {
  font-family: var(--font-mono);
  font-weight: 600;
  color: var(--text-secondary);
}

/* Entity Label (TCP, UDP, stream, dgram, etc.) */
.entity-label {
  display: inline-block;
  padding: 2px var(--space-xs);
  font-size: 9px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  background: var(--bg-tertiary);
  color: var(--text-muted);
  border-radius: var(--radius-sm);
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .file-io-row {
    grid-template-columns: 1fr;
    gap: var(--space-xs);
  }

  .file-io-spark {
    min-width: 100%;
  }

  .tcp-conn-stats,
  .tcp-throughput-stats,
  .tcp-latency-stats,
  .unix-socket-stats {
    flex-direction: column;
    gap: var(--space-sm);
  }

  .udp-stats-grid {
    grid-template-columns: 1fr;
  }
}

/* ===== COLLAPSIBLE ENTITY CARDS ===== */
.entity-card {
  transition: all 0.2s ease;
}

.entity-card.collapsed {
  border-radius: var(--radius-sm);
}

.entity-card.collapsed .entity-header {
  padding: var(--space-xs) var(--space-md);
  border-bottom: none;
}

.entity-card.collapsed .entity-body {
  display: none;
}

.entity-summary {
  display: none;
  align-items: center;
  gap: var(--space-md);
  margin-left: auto;
  margin-right: var(--space-md);
}

.entity-card.collapsed .entity-summary {
  display: flex;
}

.entity-card.collapsed .entity-stats {
  display: none;
}

.summary-metric {
  font-size: 12px;
  font-variant-numeric: tabular-nums;
  color: var(--text-secondary);
}

.summary-metric.req-rate {
  font-weight: 600;
  color: var(--text-primary);
}

.summary-metric.p99-value {
  color: var(--text-muted);
}

.summary-metric.success-rate {
  color: var(--color-ok);
}

.summary-metric.success-rate.warning {
  color: var(--color-warning);
}

.summary-metric.success-rate.error {
  color: var(--color-error);
}

.summary-spark {
  width: 60px;
  height: 16px;
}

.expand-toggle {
  background: none;
  border: none;
  color: var(--text-muted);
  cursor: pointer;
  padding: var(--space-xs);
  border-radius: var(--radius-sm);
  transition: background 0.15s;
}

.expand-toggle:hover {
  background: var(--bg-elevated);
  color: var(--text-primary);
}

.expand-icon {
  font-size: 10px;
  transition: transform 0.2s ease;
}

.entity-card:not(.collapsed) .expand-icon {
  transform: rotate(180deg);
}

.entity-card:focus {
  outline: 2px solid var(--color-info);
  outline-offset: 2px;
}

.entity-card.keyboard-focus {
  box-shadow: 0 0 0 2px var(--color-info);
}

/* ===== PHASE 4: TREND SPARKLINES ===== */
.status-code-spark {
  width: 60px;
  height: 20px;
  margin-top: var(--space-sm);
}

.latency-trend-spark {
  width: 120px;
  height: 32px;
  margin-top: var(--space-sm);
}

.status-code-spark svg,
.latency-trend-spark svg {
  display: block;
  width: 100%;
  height: 100%;
}

/* ===== PHASE 5: KEYBOARD HELP OVERLAY ===== */
.keyboard-help-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

.keyboard-help-overlay[aria-hidden="true"] {
  display: none;
}

.keyboard-help-content {
  background: var(--bg-primary);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-lg);
  padding: var(--space-xl);
  max-width: 600px;
  width: 90%;
  position: relative;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
}

.keyboard-help-content h3 {
  margin: 0 0 var(--space-lg) 0;
  color: var(--text-primary);
  font-size: 20px;
}

.keyboard-help-close {
  position: absolute;
  top: var(--space-md);
  right: var(--space-md);
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 28px;
  line-height: 1;
  cursor: pointer;
  padding: 0;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: var(--radius-sm);
  transition: background 0.2s, color 0.2s;
}

.keyboard-help-close:hover {
  background: var(--bg-elevated);
  color: var(--text-primary);
}

.keyboard-help-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--space-lg);
}

.shortcut-group h4 {
  margin: 0 0 var(--space-md) 0;
  color: var(--text-secondary);
  font-size: 14px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.shortcut {
  display: flex;
  align-items: center;
  gap: var(--space-md);
  margin-bottom: var(--space-sm);
  font-size: 14px;
  color: var(--text-secondary);
}

.shortcut kbd {
  background: var(--bg-tertiary);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-sm);
  padding: 4px 8px;
  font-family: var(--font-mono);
  font-size: 12px;
  min-width: 32px;
  text-align: center;
  color: var(--text-primary);
  box-shadow: 0 2px 0 rgba(0, 0, 0, 0.2);
}

.shortcut span {
  flex: 1;
}

@media (max-width: 600px) {
  .keyboard-help-grid {
    grid-template-columns: 1fr;
  }
}

/* ===== HTTP SERVER CARD - REDESIGNED ===== */

/* Header metrics row - inline with sparklines */
.entity-header-metrics {
  display: flex;
  align-items: center;
  gap: var(--space-lg);
  margin-left: auto;
  margin-right: var(--space-md);
  flex-shrink: 1;
  min-width: 0;
  overflow: hidden;
}

.header-metric-item {
  display: flex;
  align-items: center;
  gap: 4px;
  flex-shrink: 0;
  min-width: 0;
}

.header-metric-spark {
  width: 40px;
  height: 14px;
  background: var(--bg-elevated);
  border-radius: 2px;
  overflow: hidden;
}

.header-metric-spark svg {
  display: block;
  width: 100%;
  height: 100%;
}

.header-metric-value {
  font-size: 13px;
  font-weight: 600;
  color: var(--text-primary);
  font-variant-numeric: tabular-nums;
  min-width: 28px;
  text-align: right;
}

.header-metric-unit {
  font-size: 10px;
  color: var(--text-muted);
}

.success-metric {
  padding: 2px 6px;
  border-radius: 3px;
  background: var(--color-ok-bg);
}

.success-metric .header-metric-value {
  color: var(--color-ok);
}

.success-metric.warning {
  background: var(--color-warning-bg);
}

.success-metric.warning .header-metric-value {
  color: var(--color-warning);
}

.success-metric.error {
  background: var(--color-error-bg);
}

.success-metric.error .header-metric-value {
  color: var(--color-error);
}

/* Server metrics grid - 2x2 default, stacked on small screens */
.server-metrics-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: var(--space-md);
  min-width: 0;
}

@media (max-width: 400px) {
  .server-metrics-grid {
    grid-template-columns: 1fr;
  }
}

/* Metric panel - compact card within the server card */
.metric-panel {
  background: var(--bg-tertiary);
  border-radius: var(--radius-sm);
  padding: var(--space-md);
  border: 1px solid var(--border-muted);
  min-width: 0;
  overflow: hidden;
}

.metric-panel-header {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: var(--space-xs);
  margin-bottom: var(--space-sm);
}

.metric-panel-title {
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--text-muted);
  font-weight: 500;
}

.metric-panel-body {
  min-height: 48px;
  overflow: hidden;
}

/* Code chips - compact inline */
.code-chips {
  display: flex;
  gap: 4px;
}

.code-chips .code-chip {
  padding: 2px 6px;
  font-size: 11px;
  border-radius: 3px;
  font-weight: 500;
}

.code-chips .code-chip.s2xx { background: var(--color-ok-bg); color: var(--color-ok); }
.code-chips .code-chip.s4xx { background: var(--color-warning-bg); color: var(--color-warning); }
.code-chips .code-chip.s5xx { background: var(--color-error-bg); color: var(--color-error); }

/* Status bar - larger version */
.status-bar-large {
  height: 6px;
  border-radius: 3px;
  overflow: hidden;
  display: flex;
  background: var(--bg-elevated);
  margin-top: var(--space-sm);
}

.status-bar-large .status-segment {
  height: 100%;
  transition: width 0.3s ease;
}

.status-bar-large .status-segment.s2xx { background: var(--color-ok); }
.status-bar-large .status-segment.s4xx { background: var(--color-warning); }
.status-bar-large .status-segment.s5xx { background: var(--color-error); }

/* Status code sparkline - large */
.status-code-spark-large {
  height: 32px;
  width: 100%;
}

.status-code-spark-large svg {
  display: block;
  width: 100%;
  height: 100%;
}

/* Latency chips */
.latency-chips {
  display: flex;
  gap: 6px;
}

.latency-chip {
  display: flex;
  align-items: baseline;
  gap: 3px;
  font-size: 11px;
}

.latency-chip .label {
  color: var(--text-faint);
  text-transform: lowercase;
}

.latency-chip .value {
  font-weight: 600;
  font-variant-numeric: tabular-nums;
}

.latency-chip.p50 .value { color: var(--color-ok); }
.latency-chip.p95 .value { color: var(--color-warning); }
.latency-chip.p99 .value { color: var(--color-error); }

/* Latency trend sparkline - large */
.latency-trend-spark-large {
  height: 40px;
  width: 100%;
}

.latency-trend-spark-large svg {
  display: block;
  width: 100%;
  height: 100%;
}

/* Throughput stats */
.throughput-stats {
  display: flex;
  gap: var(--space-md);
}

.throughput-stat {
  display: flex;
  align-items: center;
  gap: 3px;
  font-size: 11px;
  font-variant-numeric: tabular-nums;
}

.throughput-stat .arrow {
  font-size: 10px;
}

.throughput-stat.in .arrow { color: var(--color-ok); }
.throughput-stat.out .arrow { color: var(--color-info); }

.throughput-stat .value {
  font-weight: 500;
  color: var(--text-secondary);
}

/* Throughput sparkline - large */
.throughput-spark-large {
  height: 32px;
  width: 100%;
}

.throughput-spark-large svg {
  display: block;
  width: 100%;
  height: 100%;
}

/* Concurrency stats */
.concurrency-stats {
  display: flex;
  gap: var(--space-md);
}

.concurrency-stat {
  display: flex;
  align-items: baseline;
  gap: 4px;
  font-size: 12px;
}

.concurrency-stat .value {
  font-weight: 600;
  font-variant-numeric: tabular-nums;
}

.concurrency-stat.conns .value { color: var(--color-purple); }
.concurrency-stat.sse .value { color: var(--color-cyan); }

.concurrency-stat .label {
  font-size: 9px;
  color: var(--text-faint);
}

/* Concurrency sparkline - large */
.concurrency-spark-large {
  height: 32px;
  width: 100%;
}

.concurrency-spark-large svg {
  display: block;
  width: 100%;
  height: 100%;
}

/* Collapsed entity card - show header metrics */
.entity-card.collapsed .entity-header-metrics {
  display: flex;
}

.entity-card:not(.collapsed) .entity-header-metrics {
  display: flex;
}

/* Entity body - better spacing */
.entity-card .entity-body {
  padding: var(--space-md);
  background: var(--bg-secondary);
}

/* Sparkline common styles */
.metric-panel-body svg polyline,
.metric-panel-body svg path {
  stroke-linecap: round;
  stroke-linejoin: round;
}

/* Animation for sparkline updates */
.metric-panel-body svg {
  transition: opacity 0.15s ease;
}

/* Responsive adjustments for header */
@media (max-width: 800px) {
  header[role="banner"] {
    padding: var(--space-sm) var(--space-md);
  }

  .header-metrics {
    gap: var(--space-md);
  }

  .header-metric-spark {
    width: 28px;
  }
}

@media (max-width: 650px) {
  .header-metric-spark {
    display: none;
  }

  .header-metrics {
    gap: var(--space-sm);
  }

  .header-metric-value {
    font-size: 11px;
  }
}

@media (max-width: 500px) {
  .logo-text span {
    display: none;
  }

  .header-metric-label {
    display: none;
  }
}

/* Responsive adjustments for entity cards */
@media (max-width: 768px) {
  .entity-header-metrics {
    gap: var(--space-md);
  }

  .header-metric-value {
    font-size: 12px;
  }

  .nested-cards-grid .entity-header {
    flex-wrap: wrap;
    gap: var(--space-xs);
  }

  .nested-cards-grid .entity-header-metrics {
    width: 100%;
    margin-left: 0;
    margin-top: var(--space-xs);
    justify-content: flex-start;
  }
}

@media (max-width: 600px) {
  .entity-header-metrics {
    gap: var(--space-sm);
  }

  .header-metric-item {
    gap: 2px;
  }

  .header-metric-value {
    font-size: 11px;
    min-width: 24px;
  }

  .header-metric-unit {
    font-size: 9px;
  }
}

@media (max-width: 480px) {
  .entity-header-metrics {
    flex-wrap: wrap;
    gap: var(--space-sm);
  }

  .server-metrics-grid {
    gap: var(--space-sm);
  }

  .metric-panel {
    padding: var(--space-sm);
  }
}


